"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/metrics/ctr";
exports.ids = ["pages/api/metrics/ctr"];
exports.modules = {

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmetrics%2Fctr&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fmetrics%2Fctr.ts&middlewareConfigBase64=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmetrics%2Fctr&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fmetrics%2Fctr.ts&middlewareConfigBase64=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   handler: () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/api-utils */ \"(api-node)/./node_modules/next/dist/server/api-utils/index.js\");\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_metrics_ctr_ts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./src/pages/api/metrics/ctr.ts */ \"(api-node)/./src/pages/api/metrics/ctr.ts\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(api-node)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(api-node)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_pages_api_metrics_ctr_ts__WEBPACK_IMPORTED_MODULE_4__]);\n_src_pages_api_metrics_ctr_ts__WEBPACK_IMPORTED_MODULE_4__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n// Import the userland code.\n\n\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_src_pages_api_metrics_ctr_ts__WEBPACK_IMPORTED_MODULE_4__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_src_pages_api_metrics_ctr_ts__WEBPACK_IMPORTED_MODULE_4__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/metrics/ctr\",\n        pathname: \"/api/metrics/ctr\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _src_pages_api_metrics_ctr_ts__WEBPACK_IMPORTED_MODULE_4__,\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || ''\n});\nasync function handler(req, res, ctx) {\n    let srcPage = \"/api/metrics/ctr\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {}\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return;\n    }\n    const { query, params, prerenderManifest, routerServerContext } = prepareResult;\n    try {\n        const method = req.method || 'GET';\n        const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.getTracer)();\n        const activeSpan = tracer.getActiveScopeSpan();\n        const onRequestError = routeModule.instrumentationOnRequestError.bind(routeModule);\n        const invokeRouteModule = async (span)=>routeModule.render(req, res, {\n                query: {\n                    ...query,\n                    ...params\n                },\n                params,\n                allowedRevalidateHeaderKeys: [],\n                multiZoneDraftMode: Boolean(false),\n                trustHostHeader: false,\n                // TODO: get this from from runtime env so manifest\n                // doesn't need to load\n                previewProps: prerenderManifest.preview,\n                propagateError: false,\n                dev: routeModule.isDev,\n                page: \"/api/metrics/ctr\",\n                internalRevalidate: routerServerContext == null ? void 0 : routerServerContext.revalidate,\n                onError: (...args)=>onRequestError(req, ...args)\n            }).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await invokeRouteModule(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, invokeRouteModule));\n        }\n    } catch (err) {\n        // we re-throw in dev to show the error overlay\n        if (routeModule.isDev) {\n            throw err;\n        }\n        // this is technically an invariant as error handling\n        // should be done inside of api-resolver onError\n        (0,next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__.sendError)(res, 500, 'Internal Server Error');\n    } finally{\n        // We don't allow any waitUntil work in pages API routes currently\n        // so if callback is present return with resolved promise since no\n        // pending work\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n    }\n}\n\n//# sourceMappingURL=pages-api.js.map\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGbWV0cmljcyUyRmN0ciZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnNyYyUyRnBhZ2VzJTJGYXBpJTJGbWV0cmljcyUyRmN0ci50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBdUQ7QUFDQztBQUN1QztBQUNyQztBQUMxRDtBQUMyRDtBQUNhO0FBQ0Y7QUFDdEU7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLDBEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQywwREFBUTtBQUNwQztBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLGFBQWEsT0FBb0MsSUFBSSxDQUFFO0FBQ3ZELHdCQUF3QixNQUF1QztBQUMvRCxDQUFDO0FBQ007QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsS0FBcUIsRUFBRSxFQUUxQjtBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx3REFBd0Q7QUFDcEU7QUFDQTtBQUNBLHVCQUF1Qiw0RUFBUztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSw2Q0FBNkMsRUFBNkM7QUFDMUYsNENBQTRDLEtBQXdDO0FBQ3BGLGlDQUFpQyxLQUFvQztBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUsZ0ZBQWM7QUFDL0UsK0RBQStELHlDQUF5QztBQUN4RztBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxRQUFRLEVBQUUsTUFBTTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBLGtCQUFrQjtBQUNsQix1Q0FBdUMsUUFBUSxFQUFFLFFBQVE7QUFDekQ7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1YsNkVBQTZFLGdGQUFjO0FBQzNGLGlDQUFpQyxRQUFRLEVBQUUsUUFBUTtBQUNuRCwwQkFBMEIsdUVBQVE7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxxRUFBUztBQUNqQixNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc2VuZEVycm9yIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvYXBpLXV0aWxzXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3NyYy9wYWdlcy9hcGkvbWV0cmljcy9jdHIudHNcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgJ2RlZmF1bHQnKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsICdjb25maWcnKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvbWV0cmljcy9jdHJcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9tZXRyaWNzL2N0clwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6ICcnLFxuICAgICAgICBmaWxlbmFtZTogJydcbiAgICB9LFxuICAgIHVzZXJsYW5kLFxuICAgIGRpc3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9ESVNUX0RJUiB8fCAnJyxcbiAgICByZWxhdGl2ZVByb2plY3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9QUk9KRUNUX0RJUiB8fCAnJ1xufSk7XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcywgY3R4KSB7XG4gICAgbGV0IHNyY1BhZ2UgPSBcIi9hcGkvbWV0cmljcy9jdHJcIjtcbiAgICAvLyB0dXJib3BhY2sgZG9lc24ndCBub3JtYWxpemUgYC9pbmRleGAgaW4gdGhlIHBhZ2UgbmFtZVxuICAgIC8vIHNvIHdlIG5lZWQgdG8gdG8gcHJvY2VzcyBkeW5hbWljIHJvdXRlcyBwcm9wZXJseVxuICAgIC8vIFRPRE86IGZpeCB0dXJib3BhY2sgcHJvdmlkaW5nIGRpZmZlcmluZyB2YWx1ZSBmcm9tIHdlYnBhY2tcbiAgICBpZiAocHJvY2Vzcy5lbnYuVFVSQk9QQUNLKSB7XG4gICAgICAgIHNyY1BhZ2UgPSBzcmNQYWdlLnJlcGxhY2UoL1xcL2luZGV4JC8sICcnKSB8fCAnLyc7XG4gICAgfVxuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2VcbiAgICB9KTtcbiAgICBpZiAoIXByZXBhcmVSZXN1bHQpIHtcbiAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDA7XG4gICAgICAgIHJlcy5lbmQoJ0JhZCBSZXF1ZXN0Jyk7XG4gICAgICAgIGN0eC53YWl0VW50aWwgPT0gbnVsbCA/IHZvaWQgMCA6IGN0eC53YWl0VW50aWwuY2FsbChjdHgsIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB7IHF1ZXJ5LCBwYXJhbXMsIHByZXJlbmRlck1hbmlmZXN0LCByb3V0ZXJTZXJ2ZXJDb250ZXh0IH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XG4gICAgICAgIGNvbnN0IHRyYWNlciA9IGdldFRyYWNlcigpO1xuICAgICAgICBjb25zdCBhY3RpdmVTcGFuID0gdHJhY2VyLmdldEFjdGl2ZVNjb3BlU3BhbigpO1xuICAgICAgICBjb25zdCBvblJlcXVlc3RFcnJvciA9IHJvdXRlTW9kdWxlLmluc3RydW1lbnRhdGlvbk9uUmVxdWVzdEVycm9yLmJpbmQocm91dGVNb2R1bGUpO1xuICAgICAgICBjb25zdCBpbnZva2VSb3V0ZU1vZHVsZSA9IGFzeW5jIChzcGFuKT0+cm91dGVNb2R1bGUucmVuZGVyKHJlcSwgcmVzLCB7XG4gICAgICAgICAgICAgICAgcXVlcnk6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4ucXVlcnksXG4gICAgICAgICAgICAgICAgICAgIC4uLnBhcmFtc1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcGFyYW1zLFxuICAgICAgICAgICAgICAgIGFsbG93ZWRSZXZhbGlkYXRlSGVhZGVyS2V5czogcHJvY2Vzcy5lbnYuX19ORVhUX0FMTE9XRURfUkVWQUxJREFURV9IRUFERVJTLFxuICAgICAgICAgICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZTogQm9vbGVhbihwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFKSxcbiAgICAgICAgICAgICAgICB0cnVzdEhvc3RIZWFkZXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9UUlVTVF9IT1NUX0hFQURFUixcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBnZXQgdGhpcyBmcm9tIGZyb20gcnVudGltZSBlbnYgc28gbWFuaWZlc3RcbiAgICAgICAgICAgICAgICAvLyBkb2Vzbid0IG5lZWQgdG8gbG9hZFxuICAgICAgICAgICAgICAgIHByZXZpZXdQcm9wczogcHJlcmVuZGVyTWFuaWZlc3QucHJldmlldyxcbiAgICAgICAgICAgICAgICBwcm9wYWdhdGVFcnJvcjogZmFsc2UsXG4gICAgICAgICAgICAgICAgZGV2OiByb3V0ZU1vZHVsZS5pc0RldixcbiAgICAgICAgICAgICAgICBwYWdlOiBcIi9hcGkvbWV0cmljcy9jdHJcIixcbiAgICAgICAgICAgICAgICBpbnRlcm5hbFJldmFsaWRhdGU6IHJvdXRlclNlcnZlckNvbnRleHQgPT0gbnVsbCA/IHZvaWQgMCA6IHJvdXRlclNlcnZlckNvbnRleHQucmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICBvbkVycm9yOiAoLi4uYXJncyk9Pm9uUmVxdWVzdEVycm9yKHJlcSwgLi4uYXJncylcbiAgICAgICAgICAgIH0pLmZpbmFsbHkoKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoIXNwYW4pIHJldHVybjtcbiAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAnaHR0cC5zdGF0dXNfY29kZSc6IHJlcy5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgICAgICAnbmV4dC5yc2MnOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvb3RTcGFuQXR0cmlidXRlcyA9IHRyYWNlci5nZXRSb290U3BhbkF0dHJpYnV0ZXMoKTtcbiAgICAgICAgICAgICAgICAvLyBXZSB3ZXJlIHVuYWJsZSB0byBnZXQgYXR0cmlidXRlcywgcHJvYmFibHkgT1RFTCBpcyBub3QgZW5hYmxlZFxuICAgICAgICAgICAgICAgIGlmICghcm9vdFNwYW5BdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJykgIT09IEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVbmV4cGVjdGVkIHJvb3Qgc3BhbiB0eXBlICcke3Jvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJyl9Jy4gUGxlYXNlIHJlcG9ydCB0aGlzIE5leHQuanMgaXNzdWUgaHR0cHM6Ly9naXRodWIuY29tL3ZlcmNlbC9uZXh0LmpzYCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgcm91dGUgPSByb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnJvdXRlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHJvdXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBgJHttZXRob2R9ICR7cm91dGV9YDtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQuc3Bhbl9uYW1lJzogbmFtZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShgJHttZXRob2R9ICR7cmVxLnVybH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgLy8gVE9ETzogYWN0aXZlU3BhbiBjb2RlIHBhdGggaXMgZm9yIHdoZW4gd3JhcHBlZCBieVxuICAgICAgICAvLyBuZXh0LXNlcnZlciBjYW4gYmUgcmVtb3ZlZCB3aGVuIHRoaXMgaXMgbm8gbG9uZ2VyIHVzZWRcbiAgICAgICAgaWYgKGFjdGl2ZVNwYW4pIHtcbiAgICAgICAgICAgIGF3YWl0IGludm9rZVJvdXRlTW9kdWxlKGFjdGl2ZVNwYW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdHJhY2VyLndpdGhQcm9wYWdhdGVkQ29udGV4dChyZXEuaGVhZGVycywgKCk9PnRyYWNlci50cmFjZShCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0LCB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW5OYW1lOiBgJHttZXRob2R9ICR7cmVxLnVybH1gLFxuICAgICAgICAgICAgICAgICAgICBraW5kOiBTcGFuS2luZC5TRVJWRVIsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLm1ldGhvZCc6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnRhcmdldCc6IHJlcS51cmxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGludm9rZVJvdXRlTW9kdWxlKSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgLy8gd2UgcmUtdGhyb3cgaW4gZGV2IHRvIHNob3cgdGhlIGVycm9yIG92ZXJsYXlcbiAgICAgICAgaWYgKHJvdXRlTW9kdWxlLmlzRGV2KSB7XG4gICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgIH1cbiAgICAgICAgLy8gdGhpcyBpcyB0ZWNobmljYWxseSBhbiBpbnZhcmlhbnQgYXMgZXJyb3IgaGFuZGxpbmdcbiAgICAgICAgLy8gc2hvdWxkIGJlIGRvbmUgaW5zaWRlIG9mIGFwaS1yZXNvbHZlciBvbkVycm9yXG4gICAgICAgIHNlbmRFcnJvcihyZXMsIDUwMCwgJ0ludGVybmFsIFNlcnZlciBFcnJvcicpO1xuICAgIH0gZmluYWxseXtcbiAgICAgICAgLy8gV2UgZG9uJ3QgYWxsb3cgYW55IHdhaXRVbnRpbCB3b3JrIGluIHBhZ2VzIEFQSSByb3V0ZXMgY3VycmVudGx5XG4gICAgICAgIC8vIHNvIGlmIGNhbGxiYWNrIGlzIHByZXNlbnQgcmV0dXJuIHdpdGggcmVzb2x2ZWQgcHJvbWlzZSBzaW5jZSBub1xuICAgICAgICAvLyBwZW5kaW5nIHdvcmtcbiAgICAgICAgY3R4LndhaXRVbnRpbCA9PSBudWxsID8gdm9pZCAwIDogY3R4LndhaXRVbnRpbC5jYWxsKGN0eCwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmetrics%2Fctr&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fmetrics%2Fctr.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./src/pages/api/metrics/ctr.ts":
/*!**************************************!*\
  !*** ./src/pages/api/metrics/ctr.ts ***!
  \**************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"zod\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([zod__WEBPACK_IMPORTED_MODULE_1__]);\nzod__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n/**\n * AdGo Platform - Advanced Advertising Technology Suite\n * \n * Copyright (c) 2025 AdGo Solutions Limited.\n * All rights reserved.\n * \n * This source code is proprietary and confidential.\n * Unauthorized copying, modification, distribution, or use of this file,\n * via any medium, is strictly prohibited without explicit written consent.\n * \n * For licensing information, please contact: legal@adgosolutions.com\n * \n * Build: 20251015_073830\n * Generated: 2025-10-15 04:38:36 UTC\n */ \n\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(\"https://rkonwkggxaohpmxmzmfn.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY);\n// Zod schemas for parameter validation\nconst MetricsQuerySchema = zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n    campaign_id: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().uuid().optional(),\n    partner_id: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().uuid().optional(),\n    period: zod__WEBPACK_IMPORTED_MODULE_1__.z.enum([\n        '1h',\n        '24h',\n        '7d',\n        '30d'\n    ]).default('24h'),\n    format: zod__WEBPACK_IMPORTED_MODULE_1__.z.enum([\n        'json',\n        'csv'\n    ]).default('json').optional()\n});\n// Enhanced metrics response schema\nconst MetricsResponseSchema = zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n    period: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n    impressions: zod__WEBPACK_IMPORTED_MODULE_1__.z.number().int().min(0),\n    clicks: zod__WEBPACK_IMPORTED_MODULE_1__.z.number().int().min(0),\n    conversions: zod__WEBPACK_IMPORTED_MODULE_1__.z.number().int().min(0).optional(),\n    ctr: zod__WEBPACK_IMPORTED_MODULE_1__.z.number().min(0).max(100),\n    conversionRate: zod__WEBPACK_IMPORTED_MODULE_1__.z.number().min(0).max(100).optional(),\n    timestamp: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().datetime()\n});\nasync function handler(req, res) {\n    try {\n        // Validate query parameters with Zod\n        const validationResult = MetricsQuerySchema.safeParse(req.query);\n        if (!validationResult.success) {\n            return res.status(400).json({\n                error: \"invalid_parameters\",\n                details: validationResult.error.issues\n            });\n        }\n        const { campaign_id, period, partner_id, format } = validationResult.data;\n        // If no specific campaign, return overall metrics\n        if (!campaign_id && !partner_id) {\n            return await getOverallMetrics(req, res, period, format);\n        }\n        // If campaign_id provided, return campaign-specific metrics\n        if (campaign_id) {\n            return await getCampaignMetrics(req, res, campaign_id, format);\n        }\n        // If partner_id provided, return partner-specific metrics\n        if (partner_id) {\n            return await getPartnerMetrics(req, res, partner_id, period, format);\n        }\n        return res.status(400).json({\n            error: \"missing_required_parameters\"\n        });\n    } catch (error) {\n        console.error('Metrics API Error:', error);\n        return res.status(500).json({\n            error: \"internal_server_error\",\n            message: error.message,\n            timestamp: new Date().toISOString()\n        });\n    }\n}\n// Get overall platform metrics\nasync function getOverallMetrics(req, res, period, format) {\n    try {\n        // Calculate date range based on period\n        const now = new Date();\n        const startDate = new Date();\n        switch(period){\n            case '1h':\n                startDate.setHours(now.getHours() - 1);\n                break;\n            case '24h':\n                startDate.setDate(now.getDate() - 1);\n                break;\n            case '7d':\n                startDate.setDate(now.getDate() - 7);\n                break;\n            case '30d':\n                startDate.setDate(now.getDate() - 30);\n                break;\n            default:\n                startDate.setDate(now.getDate() - 1);\n        }\n        // Try to use materialized view for better performance\n        let impressions = 0, clicks = 0, conversions = 0;\n        try {\n            // Select appropriate time-based columns from materialized view\n            let selectColumns = 'impressions, clicks, conversions';\n            if (period === '24h') {\n                selectColumns = 'impressions_24h, clicks_24h, conversions_24h';\n            } else if (period === '7d') {\n                selectColumns = 'impressions_7d, clicks_7d, conversions_7d';\n            }\n            const { data: aggregated, error: viewError } = await supabase.from('campaign_metrics').select(selectColumns);\n            if (!viewError && aggregated?.length > 0) {\n                // Sum metrics from materialized view\n                for (const row of aggregated){\n                    if (period === '24h') {\n                        impressions += row.impressions_24h || 0;\n                        clicks += row.clicks_24h || 0;\n                        conversions += row.conversions_24h || 0;\n                    } else if (period === '7d') {\n                        impressions += row.impressions_7d || 0;\n                        clicks += row.clicks_7d || 0;\n                        conversions += row.conversions_7d || 0;\n                    } else {\n                        impressions += row.impressions || 0;\n                        clicks += row.clicks || 0;\n                        conversions += row.conversions || 0;\n                    }\n                }\n            } else {\n                throw new Error('Materialized view not available');\n            }\n        } catch (fallbackError) {\n            // Fallback to direct query if materialized view fails\n            const { data: events, error } = await supabase.from('analytics_events').select('event_type, created_at').gte('created_at', startDate.toISOString());\n            if (error) throw error;\n            impressions = events?.filter((e)=>e.event_type === 'impression').length || 0;\n            clicks = events?.filter((e)=>e.event_type === 'click').length || 0;\n            conversions = events?.filter((e)=>e.event_type === 'conversion').length || 0;\n        }\n        const ctr = impressions > 0 ? clicks / impressions * 100 : 0;\n        const conversionRate = clicks > 0 ? conversions / clicks * 100 : 0;\n        return res.status(200).json({\n            period,\n            impressions,\n            clicks,\n            conversions,\n            ctr: Number(ctr.toFixed(2)),\n            conversionRate: Number(conversionRate.toFixed(2)),\n            timestamp: new Date().toISOString()\n        });\n    } catch (error) {\n        console.error('Overall metrics error:', error);\n        return res.status(500).json({\n            error: 'Failed to get overall metrics'\n        });\n    }\n}\n// Get campaign-specific metrics\nasync function getCampaignMetrics(req, res, campaign_id, format) {\n    try {\n        const { data, error } = await supabase.from(\"campaign_ctr\").select(\"*\").eq(\"campaign_id\", campaign_id).maybeSingle();\n        if (error && error.code !== 'PGRST116') throw error;\n        // If no data in campaign_ctr table, calculate from analytics_events\n        if (!data) {\n            const { data: events, error: eventsError } = await supabase.from('analytics_events').select('event_type').eq('campaign_id', campaign_id);\n            if (eventsError) throw eventsError;\n            const impressions = events?.filter((e)=>e.event_type === 'impression').length || 0;\n            const clicks = events?.filter((e)=>e.event_type === 'click').length || 0;\n            const ctr = impressions > 0 ? clicks / impressions * 100 : 0;\n            return res.status(200).json({\n                campaign_id,\n                impressions,\n                clicks,\n                ctr: Number(ctr.toFixed(2)),\n                calculated: true\n            });\n        }\n        return res.status(200).json(data);\n    } catch (error) {\n        console.error('Campaign metrics error:', error);\n        return res.status(500).json({\n            error: 'Failed to get campaign metrics'\n        });\n    }\n}\n// Get partner-specific metrics\nasync function getPartnerMetrics(req, res, partner_id, period, format) {\n    try {\n        // Get partner campaigns\n        const { data: campaigns, error: campaignError } = await supabase.from('campaigns').select('id').eq('partner_id', partner_id);\n        if (campaignError) throw campaignError;\n        if (!campaigns || campaigns.length === 0) {\n            return res.status(200).json({\n                partner_id,\n                period,\n                impressions: 0,\n                clicks: 0,\n                ctr: 0,\n                campaigns: 0\n            });\n        }\n        const campaignIds = campaigns.map((c)=>c.id);\n        // Get events for partner campaigns\n        const { data: events, error: eventsError } = await supabase.from('analytics_events').select('event_type, campaign_id').in('campaign_id', campaignIds);\n        if (eventsError) throw eventsError;\n        const impressions = events?.filter((e)=>e.event_type === 'impression').length || 0;\n        const clicks = events?.filter((e)=>e.event_type === 'click').length || 0;\n        const ctr = impressions > 0 ? clicks / impressions * 100 : 0;\n        return res.status(200).json({\n            partner_id,\n            period,\n            impressions,\n            clicks,\n            ctr: Number(ctr.toFixed(2)),\n            campaigns: campaigns.length\n        });\n    } catch (error) {\n        console.error('Partner metrics error:', error);\n        return res.status(500).json({\n            error: 'Failed to get partner metrics'\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9wYWdlcy9hcGkvbWV0cmljcy9jdHIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBOzs7Ozs7Ozs7Ozs7OztDQWNDLEdBR29EO0FBQzdCO0FBRXhCLE1BQU1FLFdBQVdGLG1FQUFZQSxDQUFDRywwQ0FBb0MsRUFBR0EsUUFBUUMsR0FBRyxDQUFDRSx5QkFBeUI7QUFFMUcsdUNBQXVDO0FBQ3ZDLE1BQU1DLHFCQUFxQk4sa0NBQUNBLENBQUNPLE1BQU0sQ0FBQztJQUNsQ0MsYUFBYVIsa0NBQUNBLENBQUNTLE1BQU0sR0FBR0MsSUFBSSxHQUFHQyxRQUFRO0lBQ3ZDQyxZQUFZWixrQ0FBQ0EsQ0FBQ1MsTUFBTSxHQUFHQyxJQUFJLEdBQUdDLFFBQVE7SUFDdENFLFFBQVFiLGtDQUFDQSxDQUFDYyxJQUFJLENBQUM7UUFBQztRQUFNO1FBQU87UUFBTTtLQUFNLEVBQUVDLE9BQU8sQ0FBQztJQUNuREMsUUFBUWhCLGtDQUFDQSxDQUFDYyxJQUFJLENBQUM7UUFBQztRQUFRO0tBQU0sRUFBRUMsT0FBTyxDQUFDLFFBQVFKLFFBQVE7QUFDMUQ7QUFFQSxtQ0FBbUM7QUFDbkMsTUFBTU0sd0JBQXdCakIsa0NBQUNBLENBQUNPLE1BQU0sQ0FBQztJQUNyQ00sUUFBUWIsa0NBQUNBLENBQUNTLE1BQU07SUFDaEJTLGFBQWFsQixrQ0FBQ0EsQ0FBQ21CLE1BQU0sR0FBR0MsR0FBRyxHQUFHQyxHQUFHLENBQUM7SUFDbENDLFFBQVF0QixrQ0FBQ0EsQ0FBQ21CLE1BQU0sR0FBR0MsR0FBRyxHQUFHQyxHQUFHLENBQUM7SUFDN0JFLGFBQWF2QixrQ0FBQ0EsQ0FBQ21CLE1BQU0sR0FBR0MsR0FBRyxHQUFHQyxHQUFHLENBQUMsR0FBR1YsUUFBUTtJQUM3Q2EsS0FBS3hCLGtDQUFDQSxDQUFDbUIsTUFBTSxHQUFHRSxHQUFHLENBQUMsR0FBR0ksR0FBRyxDQUFDO0lBQzNCQyxnQkFBZ0IxQixrQ0FBQ0EsQ0FBQ21CLE1BQU0sR0FBR0UsR0FB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RUMsVUFBVSxLQUFLLGNBQWNkLFVBQVU7UUFDakYsTUFBTXRDLFNBQVNnRCxRQUFRRSxPQUFPQyxDQUFBQSxJQUFLQSxFQUFFQyxVQUFVLEtBQUssU0FBU2QsVUFBVTtRQUN2RSxNQUFNcEMsTUFBTU4sY0FBYyxJQUFLLFNBQVVBLGNBQWUsTUFBTztRQUUvRCxPQUFPYSxJQUFJSyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQzFCekI7WUFDQUM7WUFDQUs7WUFDQUk7WUFDQUUsS0FBS21ELE9BQU9uRCxJQUFJb0QsT0FBTyxDQUFDO1lBQ3hCTSxXQUFXQSxVQUFVdEIsTUFBTTtRQUM3QjtJQUNGLEVBQUUsT0FBT3RCLE9BQVk7UUFDbkJPLFFBQVFQLEtBQUssQ0FBQywwQkFBMEJBO1FBQ3hDLE9BQU9QLElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsT0FBTztRQUFnQztJQUN2RTtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvZ2lvL0RvY3VtZW50cy9hZGdvL3NyYy9wYWdlcy9hcGkvbWV0cmljcy9jdHIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBZEdvIFBsYXRmb3JtIC0gQWR2YW5jZWQgQWR2ZXJ0aXNpbmcgVGVjaG5vbG9neSBTdWl0ZVxuICogXG4gKiBDb3B5cmlnaHQgKGMpIDIwMjUgQWRHbyBTb2x1dGlvbnMgTGltaXRlZC5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgcHJvcHJpZXRhcnkgYW5kIGNvbmZpZGVudGlhbC5cbiAqIFVuYXV0aG9yaXplZCBjb3B5aW5nLCBtb2RpZmljYXRpb24sIGRpc3RyaWJ1dGlvbiwgb3IgdXNlIG9mIHRoaXMgZmlsZSxcbiAqIHZpYSBhbnkgbWVkaXVtLCBpcyBzdHJpY3RseSBwcm9oaWJpdGVkIHdpdGhvdXQgZXhwbGljaXQgd3JpdHRlbiBjb25zZW50LlxuICogXG4gKiBGb3IgbGljZW5zaW5nIGluZm9ybWF0aW9uLCBwbGVhc2UgY29udGFjdDogbGVnYWxAYWRnb3NvbHV0aW9ucy5jb21cbiAqIFxuICogQnVpbGQ6IDIwMjUxMDE1XzA3MzgzMFxuICogR2VuZXJhdGVkOiAyMDI1LTEwLTE1IDA0OjM4OjM2IFVUQ1xuICovXG5cbmltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gXCJuZXh0XCI7XG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL3N1cGFiYXNlLWpzXCI7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxuY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQocHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMISwgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSEpO1xuXG4vLyBab2Qgc2NoZW1hcyBmb3IgcGFyYW1ldGVyIHZhbGlkYXRpb25cbmNvbnN0IE1ldHJpY3NRdWVyeVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgY2FtcGFpZ25faWQ6IHouc3RyaW5nKCkudXVpZCgpLm9wdGlvbmFsKCksXG4gIHBhcnRuZXJfaWQ6IHouc3RyaW5nKCkudXVpZCgpLm9wdGlvbmFsKCksIFxuICBwZXJpb2Q6IHouZW51bShbJzFoJywgJzI0aCcsICc3ZCcsICczMGQnXSkuZGVmYXVsdCgnMjRoJyksXG4gIGZvcm1hdDogei5lbnVtKFsnanNvbicsICdjc3YnXSkuZGVmYXVsdCgnanNvbicpLm9wdGlvbmFsKClcbn0pO1xuXG4vLyBFbmhhbmNlZCBtZXRyaWNzIHJlc3BvbnNlIHNjaGVtYVxuY29uc3QgTWV0cmljc1Jlc3BvbnNlU2NoZW1hID0gei5vYmplY3Qoe1xuICBwZXJpb2Q6IHouc3RyaW5nKCksXG4gIGltcHJlc3Npb25zOiB6Lm51bWJlcigpLmludCgpLm1pbigwKSxcbiAgY2xpY2tzOiB6Lm51bWJlcigpLmludCgpLm1pbigwKSxcbiAgY29udmVyc2lvbnM6IHoubnVtYmVyKCkuaW50KCkubWluKDApLm9wdGlvbmFsKCksXG4gIGN0cjogei5udW1iZXIoKS5taW4oMCkubWF4KDEwMCksXG4gIGNvbnZlcnNpb25SYXRlOiB6Lm51bWJlcigpLm1pbigwKS5tYXgoMTAwKS5vcHRpb25hbCgpLFxuICB0aW1lc3RhbXA6IHouc3RyaW5nKCkuZGF0ZXRpbWUoKVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcbiAgdHJ5IHtcbiAgICAvLyBWYWxpZGF0ZSBxdWVyeSBwYXJhbWV0ZXJzIHdpdGggWm9kXG4gICAgY29uc3QgdmFsaWRhdGlvblJlc3VsdCA9IE1ldHJpY3NRdWVyeVNjaGVtYS5zYWZlUGFyc2UocmVxLnF1ZXJ5KTtcbiAgICBcbiAgICBpZiAoIXZhbGlkYXRpb25SZXN1bHQuc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgXG4gICAgICAgIGVycm9yOiBcImludmFsaWRfcGFyYW1ldGVyc1wiLFxuICAgICAgICBkZXRhaWxzOiB2YWxpZGF0aW9uUmVzdWx0LmVycm9yLmlzc3VlcyBcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCB7IGNhbXBhaWduX2lkLCBwZXJpb2QsIHBhcnRuZXJfaWQsIGZvcm1hdCB9ID0gdmFsaWRhdGlvblJlc3VsdC5kYXRhO1xuICAgIFxuICAgIC8vIElmIG5vIHNwZWNpZmljIGNhbXBhaWduLCByZXR1cm4gb3ZlcmFsbCBtZXRyaWNzXG4gICAgaWYgKCFjYW1wYWlnbl9pZCAmJiAhcGFydG5lcl9pZCkge1xuICAgICAgcmV0dXJuIGF3YWl0IGdldE92ZXJhbGxNZXRyaWNzKHJlcSwgcmVzLCBwZXJpb2QsIGZvcm1hdCk7XG4gICAgfVxuICAgIFxuICAgIC8vIElmIGNhbXBhaWduX2lkIHByb3ZpZGVkLCByZXR1cm4gY2FtcGFpZ24tc3BlY2lmaWMgbWV0cmljc1xuICAgIGlmIChjYW1wYWlnbl9pZCkge1xuICAgICAgcmV0dXJuIGF3YWl0IGdldENhbXBhaWduTWV0cmljcyhyZXEsIHJlcywgY2FtcGFpZ25faWQsIGZvcm1hdCk7XG4gICAgfVxuICAgIFxuICAgIC8vIElmIHBhcnRuZXJfaWQgcHJvdmlkZWQsIHJldHVybiBwYXJ0bmVyLXNwZWNpZmljIG1ldHJpY3NcbiAgICBpZiAocGFydG5lcl9pZCkge1xuICAgICAgcmV0dXJuIGF3YWl0IGdldFBhcnRuZXJNZXRyaWNzKHJlcSwgcmVzLCBwYXJ0bmVyX2lkLCBwZXJpb2QsIGZvcm1hdCk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiBcIm1pc3NpbmdfcmVxdWlyZWRfcGFyYW1ldGVyc1wiIH0pO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcignTWV0cmljcyBBUEkgRXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IFxuICAgICAgZXJyb3I6IFwiaW50ZXJuYWxfc2VydmVyX2Vycm9yXCIsIFxuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfSk7XG4gIH1cbn1cblxuLy8gR2V0IG92ZXJhbGwgcGxhdGZvcm0gbWV0cmljc1xuYXN5bmMgZnVuY3Rpb24gZ2V0T3ZlcmFsbE1ldHJpY3MocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UsIHBlcmlvZDogc3RyaW5nLCBmb3JtYXQ/OiBzdHJpbmcpIHtcbiAgdHJ5IHtcbiAgICAvLyBDYWxjdWxhdGUgZGF0ZSByYW5nZSBiYXNlZCBvbiBwZXJpb2RcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgXG4gICAgc3dpdGNoIChwZXJpb2QpIHtcbiAgICAgIGNhc2UgJzFoJzpcbiAgICAgICAgc3RhcnREYXRlLnNldEhvdXJzKG5vdy5nZXRIb3VycygpIC0gMSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnMjRoJzpcbiAgICAgICAgc3RhcnREYXRlLnNldERhdGUobm93LmdldERhdGUoKSAtIDEpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJzdkJzpcbiAgICAgICAgc3RhcnREYXRlLnNldERhdGUobm93LmdldERhdGUoKSAtIDcpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJzMwZCc6XG4gICAgICAgIHN0YXJ0RGF0ZS5zZXREYXRlKG5vdy5nZXREYXRlKCkgLSAzMCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgc3RhcnREYXRlLnNldERhdGUobm93LmdldERhdGUoKSAtIDEpO1xuICAgIH1cbiAgICBcbiAgICAvLyBUcnkgdG8gdXNlIG1hdGVyaWFsaXplZCB2aWV3IGZvciBiZXR0ZXIgcGVyZm9ybWFuY2VcbiAgICBsZXQgaW1wcmVzc2lvbnMgPSAwLCBjbGlja3MgPSAwLCBjb252ZXJzaW9ucyA9IDA7XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIC8vIFNlbGVjdCBhcHByb3ByaWF0ZSB0aW1lLWJhc2VkIGNvbHVtbnMgZnJvbSBtYXRlcmlhbGl6ZWQgdmlld1xuICAgICAgbGV0IHNlbGVjdENvbHVtbnMgPSAnaW1wcmVzc2lvbnMsIGNsaWNrcywgY29udmVyc2lvbnMnO1xuICAgICAgaWYgKHBlcmlvZCA9PT0gJzI0aCcpIHtcbiAgICAgICAgc2VsZWN0Q29sdW1ucyA9ICdpbXByZXNzaW9uc18yNGgsIGNsaWNrc18yNGgsIGNvbnZlcnNpb25zXzI0aCc7XG4gICAgICB9IGVsc2UgaWYgKHBlcmlvZCA9PT0gJzdkJykge1xuICAgICAgICBzZWxlY3RDb2x1bW5zID0gJ2ltcHJlc3Npb25zXzdkLCBjbGlja3NfN2QsIGNvbnZlcnNpb25zXzdkJzsgIFxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGRhdGE6IGFnZ3JlZ2F0ZWQsIGVycm9yOiB2aWV3RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjYW1wYWlnbl9tZXRyaWNzJylcbiAgICAgICAgLnNlbGVjdChzZWxlY3RDb2x1bW5zKTtcbiAgICAgIFxuICAgICAgaWYgKCF2aWV3RXJyb3IgJiYgYWdncmVnYXRlZD8ubGVuZ3RoID4gMCkge1xuICAgICAgICAvLyBTdW0gbWV0cmljcyBmcm9tIG1hdGVyaWFsaXplZCB2aWV3XG4gICAgICAgIGZvciAoY29uc3Qgcm93IG9mIGFnZ3JlZ2F0ZWQpIHtcbiAgICAgICAgICBpZiAocGVyaW9kID09PSAnMjRoJykge1xuICAgICAgICAgICAgaW1wcmVzc2lvbnMgKz0gKHJvdyBhcyBhbnkpLmltcHJlc3Npb25zXzI0aCB8fCAwO1xuICAgICAgICAgICAgY2xpY2tzICs9IChyb3cgYXMgYW55KS5jbGlja3NfMjRoIHx8IDA7XG4gICAgICAgICAgICBjb252ZXJzaW9ucyArPSAocm93IGFzIGFueSkuY29udmVyc2lvbnNfMjRoIHx8IDA7XG4gICAgICAgICAgfSBlbHNlIGlmIChwZXJpb2QgPT09ICc3ZCcpIHtcbiAgICAgICAgICAgIGltcHJlc3Npb25zICs9IChyb3cgYXMgYW55KS5pbXByZXNzaW9uc183ZCB8fCAwO1xuICAgICAgICAgICAgY2xpY2tzICs9IChyb3cgYXMgYW55KS5jbGlja3NfN2QgfHwgMDtcbiAgICAgICAgICAgIGNvbnZlcnNpb25zICs9IChyb3cgYXMgYW55KS5jb252ZXJzaW9uc183ZCB8fCAwO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbXByZXNzaW9ucyArPSAocm93IGFzIGFueSkuaW1wcmVzc2lvbnMgfHwgMDtcbiAgICAgICAgICAgIGNsaWNrcyArPSAocm93IGFzIGFueSkuY2xpY2tzIHx8IDA7XG4gICAgICAgICAgICBjb252ZXJzaW9ucyArPSAocm93IGFzIGFueSkuY29udmVyc2lvbnMgfHwgMDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWF0ZXJpYWxpemVkIHZpZXcgbm90IGF2YWlsYWJsZScpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGZhbGxiYWNrRXJyb3IpIHtcbiAgICAgIC8vIEZhbGxiYWNrIHRvIGRpcmVjdCBxdWVyeSBpZiBtYXRlcmlhbGl6ZWQgdmlldyBmYWlsc1xuICAgICAgY29uc3QgeyBkYXRhOiBldmVudHMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnYW5hbHl0aWNzX2V2ZW50cycpXG4gICAgICAgIC5zZWxlY3QoJ2V2ZW50X3R5cGUsIGNyZWF0ZWRfYXQnKVxuICAgICAgICAuZ3RlKCdjcmVhdGVkX2F0Jywgc3RhcnREYXRlLnRvSVNPU3RyaW5nKCkpO1xuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICAgICAgXG4gICAgICBpbXByZXNzaW9ucyA9IGV2ZW50cz8uZmlsdGVyKGUgPT4gZS5ldmVudF90eXBlID09PSAnaW1wcmVzc2lvbicpLmxlbmd0aCB8fCAwO1xuICAgICAgY2xpY2tzID0gZXZlbnRzPy5maWx0ZXIoZSA9PiBlLmV2ZW50X3R5cGUgPT09ICdjbGljaycpLmxlbmd0aCB8fCAwO1xuICAgICAgY29udmVyc2lvbnMgPSBldmVudHM/LmZpbHRlcihlID0+IGUuZXZlbnRfdHlwZSA9PT0gJ2NvbnZlcnNpb24nKS5sZW5ndGggfHwgMDtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgY3RyID0gaW1wcmVzc2lvbnMgPiAwID8gKChjbGlja3MgLyBpbXByZXNzaW9ucykgKiAxMDApIDogMDtcbiAgICBjb25zdCBjb252ZXJzaW9uUmF0ZSA9IGNsaWNrcyA+IDAgPyAoKGNvbnZlcnNpb25zIC8gY2xpY2tzKSAqIDEwMCkgOiAwO1xuICAgIFxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICBwZXJpb2QsXG4gICAgICBpbXByZXNzaW9ucyxcbiAgICAgIGNsaWNrcyxcbiAgICAgIGNvbnZlcnNpb25zLFxuICAgICAgY3RyOiBOdW1iZXIoY3RyLnRvRml4ZWQoMikpLFxuICAgICAgY29udmVyc2lvblJhdGU6IE51bWJlcihjb252ZXJzaW9uUmF0ZS50b0ZpeGVkKDIpKSxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBjb25zb2xlLmVycm9yKCdPdmVyYWxsIG1ldHJpY3MgZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIGdldCBvdmVyYWxsIG1ldHJpY3MnIH0pO1xuICB9XG59XG5cbi8vIEdldCBjYW1wYWlnbi1zcGVjaWZpYyBtZXRyaWNzXG5hc3luYyBmdW5jdGlvbiBnZXRDYW1wYWlnbk1ldHJpY3MocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UsIGNhbXBhaWduX2lkOiBzdHJpbmcsIGZvcm1hdD86IHN0cmluZykge1xuICB0cnkge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbShcImNhbXBhaWduX2N0clwiKVxuICAgICAgLnNlbGVjdChcIipcIilcbiAgICAgIC5lcShcImNhbXBhaWduX2lkXCIsIGNhbXBhaWduX2lkKVxuICAgICAgLm1heWJlU2luZ2xlKCk7XG4gICAgXG4gICAgaWYgKGVycm9yICYmIGVycm9yLmNvZGUgIT09ICdQR1JTVDExNicpIHRocm93IGVycm9yO1xuICAgIFxuICAgIC8vIElmIG5vIGRhdGEgaW4gY2FtcGFpZ25fY3RyIHRhYmxlLCBjYWxjdWxhdGUgZnJvbSBhbmFseXRpY3NfZXZlbnRzXG4gICAgaWYgKCFkYXRhKSB7XG4gICAgICBjb25zdCB7IGRhdGE6IGV2ZW50cywgZXJyb3I6IGV2ZW50c0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnYW5hbHl0aWNzX2V2ZW50cycpXG4gICAgICAgIC5zZWxlY3QoJ2V2ZW50X3R5cGUnKVxuICAgICAgICAuZXEoJ2NhbXBhaWduX2lkJywgY2FtcGFpZ25faWQpO1xuICAgICAgXG4gICAgICBpZiAoZXZlbnRzRXJyb3IpIHRocm93IGV2ZW50c0Vycm9yO1xuICAgICAgXG4gICAgICBjb25zdCBpbXByZXNzaW9ucyA9IGV2ZW50cz8uZmlsdGVyKGUgPT4gZS5ldmVudF90eXBlID09PSAnaW1wcmVzc2lvbicpLmxlbmd0aCB8fCAwO1xuICAgICAgY29uc3QgY2xpY2tzID0gZXZlbnRzPy5maWx0ZXIoZSA9PiBlLmV2ZW50X3R5cGUgPT09ICdjbGljaycpLmxlbmd0aCB8fCAwO1xuICAgICAgY29uc3QgY3RyID0gaW1wcmVzc2lvbnMgPiAwID8gKChjbGlja3MgLyBpbXByZXNzaW9ucykgKiAxMDApIDogMDtcbiAgICAgIFxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgICAgY2FtcGFpZ25faWQsXG4gICAgICAgIGltcHJlc3Npb25zLFxuICAgICAgICBjbGlja3MsXG4gICAgICAgIGN0cjogTnVtYmVyKGN0ci50b0ZpeGVkKDIpKSxcbiAgICAgICAgY2FsY3VsYXRlZDogdHJ1ZVxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihkYXRhKTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0NhbXBhaWduIG1ldHJpY3MgZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIGdldCBjYW1wYWlnbiBtZXRyaWNzJyB9KTtcbiAgfVxufVxuXG4vLyBHZXQgcGFydG5lci1zcGVjaWZpYyBtZXRyaWNzXG5hc3luYyBmdW5jdGlvbiBnZXRQYXJ0bmVyTWV0cmljcyhyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSwgcGFydG5lcl9pZDogc3RyaW5nLCBwZXJpb2Q6IHN0cmluZywgZm9ybWF0Pzogc3RyaW5nKSB7XG4gIHRyeSB7XG4gICAgLy8gR2V0IHBhcnRuZXIgY2FtcGFpZ25zXG4gICAgY29uc3QgeyBkYXRhOiBjYW1wYWlnbnMsIGVycm9yOiBjYW1wYWlnbkVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2NhbXBhaWducycpXG4gICAgICAuc2VsZWN0KCdpZCcpXG4gICAgICAuZXEoJ3BhcnRuZXJfaWQnLCBwYXJ0bmVyX2lkKTtcbiAgICBcbiAgICBpZiAoY2FtcGFpZ25FcnJvcikgdGhyb3cgY2FtcGFpZ25FcnJvcjtcbiAgICBcbiAgICBpZiAoIWNhbXBhaWducyB8fCBjYW1wYWlnbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgICBwYXJ0bmVyX2lkLFxuICAgICAgICBwZXJpb2QsXG4gICAgICAgIGltcHJlc3Npb25zOiAwLFxuICAgICAgICBjbGlja3M6IDAsXG4gICAgICAgIGN0cjogMCxcbiAgICAgICAgY2FtcGFpZ25zOiAwXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgY2FtcGFpZ25JZHMgPSBjYW1wYWlnbnMubWFwKGMgPT4gYy5pZCk7XG4gICAgXG4gICAgLy8gR2V0IGV2ZW50cyBmb3IgcGFydG5lciBjYW1wYWlnbnNcbiAgICBjb25zdCB7IGRhdGE6IGV2ZW50cywgZXJyb3I6IGV2ZW50c0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2FuYWx5dGljc19ldmVudHMnKVxuICAgICAgLnNlbGVjdCgnZXZlbnRfdHlwZSwgY2FtcGFpZ25faWQnKVxuICAgICAgLmluKCdjYW1wYWlnbl9pZCcsIGNhbXBhaWduSWRzKTtcbiAgICBcbiAgICBpZiAoZXZlbnRzRXJyb3IpIHRocm93IGV2ZW50c0Vycm9yO1xuICAgIFxuICAgIGNvbnN0IGltcHJlc3Npb25zID0gZXZlbnRzPy5maWx0ZXIoZSA9PiBlLmV2ZW50X3R5cGUgPT09ICdpbXByZXNzaW9uJykubGVuZ3RoIHx8IDA7XG4gICAgY29uc3QgY2xpY2tzID0gZXZlbnRzPy5maWx0ZXIoZSA9PiBlLmV2ZW50X3R5cGUgPT09ICdjbGljaycpLmxlbmd0aCB8fCAwO1xuICAgIGNvbnN0IGN0ciA9IGltcHJlc3Npb25zID4gMCA/ICgoY2xpY2tzIC8gaW1wcmVzc2lvbnMpICogMTAwKSA6IDA7XG4gICAgXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgIHBhcnRuZXJfaWQsXG4gICAgICBwZXJpb2QsXG4gICAgICBpbXByZXNzaW9ucyxcbiAgICAgIGNsaWNrcyxcbiAgICAgIGN0cjogTnVtYmVyKGN0ci50b0ZpeGVkKDIpKSxcbiAgICAgIGNhbXBhaWduczogY2FtcGFpZ25zLmxlbmd0aFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcignUGFydG5lciBtZXRyaWNzIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0ZhaWxlZCB0byBnZXQgcGFydG5lciBtZXRyaWNzJyB9KTtcbiAgfVxufSJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJ6Iiwic3VwYWJhc2UiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsIk1ldHJpY3NRdWVyeVNjaGVtYSIsIm9iamVjdCIsImNhbXBhaWduX2lkIiwic3RyaW5nIiwidXVpZCIsIm9wdGlvbmFsIiwicGFydG5lcl9pZCIsInBlcmlvZCIsImVudW0iLCJkZWZhdWx0IiwiZm9ybWF0IiwiTWV0cmljc1Jlc3BvbnNlU2NoZW1hIiwiaW1wcmVzc2lvbnMiLCJudW1iZXIiLCJpbnQiLCJtaW4iLCJjbGlja3MiLCJjb252ZXJzaW9ucyIsImN0ciIsIm1heCIsImNvbnZlcnNpb25SYXRlIiwidGltZXN0YW1wIiwiZGF0ZXRpbWUiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwidmFsaWRhdGlvblJlc3VsdCIsInNhZmVQYXJzZSIsInF1ZXJ5Iiwic3VjY2VzcyIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImRldGFpbHMiLCJpc3N1ZXMiLCJkYXRhIiwiZ2V0T3ZlcmFsbE1ldHJpY3MiLCJnZXRDYW1wYWlnbk1ldHJpY3MiLCJnZXRQYXJ0bmVyTWV0cmljcyIsImNvbnNvbGUiLCJtZXNzYWdlIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwibm93Iiwic3RhcnREYXRlIiwic2V0SG91cnMiLCJnZXRIb3VycyIsInNldERhdGUiLCJnZXREYXRlIiwic2VsZWN0Q29sdW1ucyIsImFnZ3JlZ2F0ZWQiLCJ2aWV3RXJyb3IiLCJmcm9tIiwic2VsZWN0IiwibGVuZ3RoIiwicm93IiwiaW1wcmVzc2lvbnNfMjRoIiwiY2xpY2tzXzI0aCIsImNvbnZlcnNpb25zXzI0aCIsImltcHJlc3Npb25zXzdkIiwiY2xpY2tzXzdkIiwiY29udmVyc2lvbnNfN2QiLCJFcnJvciIsImZhbGxiYWNrRXJyb3IiLCJldmVudHMiLCJndGUiLCJmaWx0ZXIiLCJlIiwiZXZlbnRfdHlwZSIsIk51bWJlciIsInRvRml4ZWQiLCJlcSIsIm1heWJlU2luZ2xlIiwiY29kZSIsImV2ZW50c0Vycm9yIiwiY2FsY3VsYXRlZCIsImNhbXBhaWducyIsImNhbXBhaWduRXJyb3IiLCJjYW1wYWlnbklkcyIsIm1hcCIsImMiLCJpZCIsImluIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./src/pages/api/metrics/ctr.ts\n");

/***/ }),

/***/ "@opentelemetry/api":
/*!*************************************!*\
  !*** external "@opentelemetry/api" ***!
  \*************************************/
/***/ ((module) => {

module.exports = require("@opentelemetry/api");

/***/ }),

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "zod":
/*!**********************!*\
  !*** external "zod" ***!
  \**********************/
/***/ ((module) => {

module.exports = import("zod");;

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmetrics%2Fctr&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fmetrics%2Fctr.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();
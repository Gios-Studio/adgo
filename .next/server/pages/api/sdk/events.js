"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/sdk/events";
exports.ids = ["pages/api/sdk/events"];
exports.modules = {

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsdk%2Fevents&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fsdk%2Fevents.ts&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsdk%2Fevents&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fsdk%2Fevents.ts&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   handler: () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/api-utils */ \"(api-node)/./node_modules/next/dist/server/api-utils/index.js\");\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_sdk_events_ts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./src/pages/api/sdk/events.ts */ \"(api-node)/./src/pages/api/sdk/events.ts\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(api-node)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(api-node)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_pages_api_sdk_events_ts__WEBPACK_IMPORTED_MODULE_4__]);\n_src_pages_api_sdk_events_ts__WEBPACK_IMPORTED_MODULE_4__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n// Import the userland code.\n\n\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_src_pages_api_sdk_events_ts__WEBPACK_IMPORTED_MODULE_4__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_src_pages_api_sdk_events_ts__WEBPACK_IMPORTED_MODULE_4__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/sdk/events\",\n        pathname: \"/api/sdk/events\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _src_pages_api_sdk_events_ts__WEBPACK_IMPORTED_MODULE_4__,\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || ''\n});\nasync function handler(req, res, ctx) {\n    let srcPage = \"/api/sdk/events\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {}\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return;\n    }\n    const { query, params, prerenderManifest, routerServerContext } = prepareResult;\n    try {\n        const method = req.method || 'GET';\n        const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.getTracer)();\n        const activeSpan = tracer.getActiveScopeSpan();\n        const onRequestError = routeModule.instrumentationOnRequestError.bind(routeModule);\n        const invokeRouteModule = async (span)=>routeModule.render(req, res, {\n                query: {\n                    ...query,\n                    ...params\n                },\n                params,\n                allowedRevalidateHeaderKeys: [],\n                multiZoneDraftMode: Boolean(false),\n                trustHostHeader: false,\n                // TODO: get this from from runtime env so manifest\n                // doesn't need to load\n                previewProps: prerenderManifest.preview,\n                propagateError: false,\n                dev: routeModule.isDev,\n                page: \"/api/sdk/events\",\n                internalRevalidate: routerServerContext == null ? void 0 : routerServerContext.revalidate,\n                onError: (...args)=>onRequestError(req, ...args)\n            }).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await invokeRouteModule(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, invokeRouteModule));\n        }\n    } catch (err) {\n        // we re-throw in dev to show the error overlay\n        if (routeModule.isDev) {\n            throw err;\n        }\n        // this is technically an invariant as error handling\n        // should be done inside of api-resolver onError\n        (0,next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__.sendError)(res, 500, 'Internal Server Error');\n    } finally{\n        // We don't allow any waitUntil work in pages API routes currently\n        // so if callback is present return with resolved promise since no\n        // pending work\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n    }\n}\n\n//# sourceMappingURL=pages-api.js.map\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGc2RrJTJGZXZlbnRzJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGc3JjJTJGcGFnZXMlMkZhcGklMkZzZGslMkZldmVudHMudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXVEO0FBQ0M7QUFDdUM7QUFDckM7QUFDMUQ7QUFDMEQ7QUFDYztBQUNGO0FBQ3RFO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx5REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMseURBQVE7QUFDcEM7QUFDQSx3QkFBd0IseUdBQW1CO0FBQzNDO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixhQUFhLE9BQW9DLElBQUksQ0FBRTtBQUN2RCx3QkFBd0IsTUFBdUM7QUFDL0QsQ0FBQztBQUNNO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLEtBQXFCLEVBQUUsRUFFMUI7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksd0RBQXdEO0FBQ3BFO0FBQ0E7QUFDQSx1QkFBdUIsNEVBQVM7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsNkNBQTZDLEVBQTZDO0FBQzFGLDRDQUE0QyxLQUF3QztBQUNwRixpQ0FBaUMsS0FBb0M7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLGdGQUFjO0FBQy9FLCtEQUErRCx5Q0FBeUM7QUFDeEc7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsUUFBUSxFQUFFLE1BQU07QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxrQkFBa0I7QUFDbEIsdUNBQXVDLFFBQVEsRUFBRSxRQUFRO0FBQ3pEO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDZFQUE2RSxnRkFBYztBQUMzRixpQ0FBaUMsUUFBUSxFQUFFLFFBQVE7QUFDbkQsMEJBQTBCLHVFQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEscUVBQVM7QUFDakIsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNlbmRFcnJvciB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2FwaS11dGlsc1wiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9zcmMvcGFnZXMvYXBpL3Nkay9ldmVudHMudHNcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgJ2RlZmF1bHQnKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsICdjb25maWcnKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc2RrL2V2ZW50c1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3Nkay9ldmVudHNcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiAnJyxcbiAgICAgICAgZmlsZW5hbWU6ICcnXG4gICAgfSxcbiAgICB1c2VybGFuZCxcbiAgICBkaXN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfRElTVF9ESVIgfHwgJycsXG4gICAgcmVsYXRpdmVQcm9qZWN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfUFJPSkVDVF9ESVIgfHwgJydcbn0pO1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMsIGN0eCkge1xuICAgIGxldCBzcmNQYWdlID0gXCIvYXBpL3Nkay9ldmVudHNcIjtcbiAgICAvLyB0dXJib3BhY2sgZG9lc24ndCBub3JtYWxpemUgYC9pbmRleGAgaW4gdGhlIHBhZ2UgbmFtZVxuICAgIC8vIHNvIHdlIG5lZWQgdG8gdG8gcHJvY2VzcyBkeW5hbWljIHJvdXRlcyBwcm9wZXJseVxuICAgIC8vIFRPRE86IGZpeCB0dXJib3BhY2sgcHJvdmlkaW5nIGRpZmZlcmluZyB2YWx1ZSBmcm9tIHdlYnBhY2tcbiAgICBpZiAocHJvY2Vzcy5lbnYuVFVSQk9QQUNLKSB7XG4gICAgICAgIHNyY1BhZ2UgPSBzcmNQYWdlLnJlcGxhY2UoL1xcL2luZGV4JC8sICcnKSB8fCAnLyc7XG4gICAgfVxuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2VcbiAgICB9KTtcbiAgICBpZiAoIXByZXBhcmVSZXN1bHQpIHtcbiAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDA7XG4gICAgICAgIHJlcy5lbmQoJ0JhZCBSZXF1ZXN0Jyk7XG4gICAgICAgIGN0eC53YWl0VW50aWwgPT0gbnVsbCA/IHZvaWQgMCA6IGN0eC53YWl0VW50aWwuY2FsbChjdHgsIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB7IHF1ZXJ5LCBwYXJhbXMsIHByZXJlbmRlck1hbmlmZXN0LCByb3V0ZXJTZXJ2ZXJDb250ZXh0IH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XG4gICAgICAgIGNvbnN0IHRyYWNlciA9IGdldFRyYWNlcigpO1xuICAgICAgICBjb25zdCBhY3RpdmVTcGFuID0gdHJhY2VyLmdldEFjdGl2ZVNjb3BlU3BhbigpO1xuICAgICAgICBjb25zdCBvblJlcXVlc3RFcnJvciA9IHJvdXRlTW9kdWxlLmluc3RydW1lbnRhdGlvbk9uUmVxdWVzdEVycm9yLmJpbmQocm91dGVNb2R1bGUpO1xuICAgICAgICBjb25zdCBpbnZva2VSb3V0ZU1vZHVsZSA9IGFzeW5jIChzcGFuKT0+cm91dGVNb2R1bGUucmVuZGVyKHJlcSwgcmVzLCB7XG4gICAgICAgICAgICAgICAgcXVlcnk6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4ucXVlcnksXG4gICAgICAgICAgICAgICAgICAgIC4uLnBhcmFtc1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcGFyYW1zLFxuICAgICAgICAgICAgICAgIGFsbG93ZWRSZXZhbGlkYXRlSGVhZGVyS2V5czogcHJvY2Vzcy5lbnYuX19ORVhUX0FMTE9XRURfUkVWQUxJREFURV9IRUFERVJTLFxuICAgICAgICAgICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZTogQm9vbGVhbihwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFKSxcbiAgICAgICAgICAgICAgICB0cnVzdEhvc3RIZWFkZXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9UUlVTVF9IT1NUX0hFQURFUixcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBnZXQgdGhpcyBmcm9tIGZyb20gcnVudGltZSBlbnYgc28gbWFuaWZlc3RcbiAgICAgICAgICAgICAgICAvLyBkb2Vzbid0IG5lZWQgdG8gbG9hZFxuICAgICAgICAgICAgICAgIHByZXZpZXdQcm9wczogcHJlcmVuZGVyTWFuaWZlc3QucHJldmlldyxcbiAgICAgICAgICAgICAgICBwcm9wYWdhdGVFcnJvcjogZmFsc2UsXG4gICAgICAgICAgICAgICAgZGV2OiByb3V0ZU1vZHVsZS5pc0RldixcbiAgICAgICAgICAgICAgICBwYWdlOiBcIi9hcGkvc2RrL2V2ZW50c1wiLFxuICAgICAgICAgICAgICAgIGludGVybmFsUmV2YWxpZGF0ZTogcm91dGVyU2VydmVyQ29udGV4dCA9PSBudWxsID8gdm9pZCAwIDogcm91dGVyU2VydmVyQ29udGV4dC5yZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgIG9uRXJyb3I6ICguLi5hcmdzKT0+b25SZXF1ZXN0RXJyb3IocmVxLCAuLi5hcmdzKVxuICAgICAgICAgICAgfSkuZmluYWxseSgoKT0+e1xuICAgICAgICAgICAgICAgIGlmICghc3BhbikgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICdodHRwLnN0YXR1c19jb2RlJzogcmVzLnN0YXR1c0NvZGUsXG4gICAgICAgICAgICAgICAgICAgICduZXh0LnJzYyc6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgcm9vdFNwYW5BdHRyaWJ1dGVzID0gdHJhY2VyLmdldFJvb3RTcGFuQXR0cmlidXRlcygpO1xuICAgICAgICAgICAgICAgIC8vIFdlIHdlcmUgdW5hYmxlIHRvIGdldCBhdHRyaWJ1dGVzLCBwcm9iYWJseSBPVEVMIGlzIG5vdCBlbmFibGVkXG4gICAgICAgICAgICAgICAgaWYgKCFyb290U3BhbkF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKSAhPT0gQmFzZVNlcnZlclNwYW4uaGFuZGxlUmVxdWVzdCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFVuZXhwZWN0ZWQgcm9vdCBzcGFuIHR5cGUgJyR7cm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKX0nLiBQbGVhc2UgcmVwb3J0IHRoaXMgTmV4dC5qcyBpc3N1ZSBodHRwczovL2dpdGh1Yi5jb20vdmVyY2VsL25leHQuanNgKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCByb3V0ZSA9IHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQucm91dGUnKTtcbiAgICAgICAgICAgICAgICBpZiAocm91dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IGAke21ldGhvZH0gJHtyb3V0ZX1gO1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQucm91dGUnOiByb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5zcGFuX25hbWUnOiBuYW1lXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUobmFtZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKGAke21ldGhvZH0gJHtyZXEudXJsfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAvLyBUT0RPOiBhY3RpdmVTcGFuIGNvZGUgcGF0aCBpcyBmb3Igd2hlbiB3cmFwcGVkIGJ5XG4gICAgICAgIC8vIG5leHQtc2VydmVyIGNhbiBiZSByZW1vdmVkIHdoZW4gdGhpcyBpcyBubyBsb25nZXIgdXNlZFxuICAgICAgICBpZiAoYWN0aXZlU3Bhbikge1xuICAgICAgICAgICAgYXdhaXQgaW52b2tlUm91dGVNb2R1bGUoYWN0aXZlU3Bhbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhd2FpdCB0cmFjZXIud2l0aFByb3BhZ2F0ZWRDb250ZXh0KHJlcS5oZWFkZXJzLCAoKT0+dHJhY2VyLnRyYWNlKEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QsIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbk5hbWU6IGAke21ldGhvZH0gJHtyZXEudXJsfWAsXG4gICAgICAgICAgICAgICAgICAgIGtpbmQ6IFNwYW5LaW5kLlNFUlZFUixcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAubWV0aG9kJzogbWV0aG9kLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAudGFyZ2V0JzogcmVxLnVybFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgaW52b2tlUm91dGVNb2R1bGUpKTtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAvLyB3ZSByZS10aHJvdyBpbiBkZXYgdG8gc2hvdyB0aGUgZXJyb3Igb3ZlcmxheVxuICAgICAgICBpZiAocm91dGVNb2R1bGUuaXNEZXYpIHtcbiAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgfVxuICAgICAgICAvLyB0aGlzIGlzIHRlY2huaWNhbGx5IGFuIGludmFyaWFudCBhcyBlcnJvciBoYW5kbGluZ1xuICAgICAgICAvLyBzaG91bGQgYmUgZG9uZSBpbnNpZGUgb2YgYXBpLXJlc29sdmVyIG9uRXJyb3JcbiAgICAgICAgc2VuZEVycm9yKHJlcywgNTAwLCAnSW50ZXJuYWwgU2VydmVyIEVycm9yJyk7XG4gICAgfSBmaW5hbGx5e1xuICAgICAgICAvLyBXZSBkb24ndCBhbGxvdyBhbnkgd2FpdFVudGlsIHdvcmsgaW4gcGFnZXMgQVBJIHJvdXRlcyBjdXJyZW50bHlcbiAgICAgICAgLy8gc28gaWYgY2FsbGJhY2sgaXMgcHJlc2VudCByZXR1cm4gd2l0aCByZXNvbHZlZCBwcm9taXNlIHNpbmNlIG5vXG4gICAgICAgIC8vIHBlbmRpbmcgd29ya1xuICAgICAgICBjdHgud2FpdFVudGlsID09IG51bGwgPyB2b2lkIDAgOiBjdHgud2FpdFVudGlsLmNhbGwoY3R4LCBQcm9taXNlLnJlc29sdmUoKSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsdk%2Fevents&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fsdk%2Fevents.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./src/pages/api/sdk/events.ts":
/*!*************************************!*\
  !*** ./src/pages/api/sdk/events.ts ***!
  \*************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! uuid */ \"uuid\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([uuid__WEBPACK_IMPORTED_MODULE_1__]);\nuuid__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n/**\n * AdGo Platform - Advanced Advertising Technology Suite\n * \n * Copyright (c) 2025 AdGo Solutions Limited.\n * All rights reserved.\n * \n * This source code is proprietary and confidential.\n * Unauthorized copying, modification, distribution, or use of this file,\n * via any medium, is strictly prohibited without explicit written consent.\n * \n * For licensing information, please contact: legal@adgosolutions.com\n * \n * Build: 20251015_073830\n * Generated: 2025-10-15 04:38:36 UTC\n */ \n\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(\"https://rkonwkggxaohpmxmzmfn.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY);\n// Helper function to validate and normalize ride_id format\nfunction normalizeRideId(ride_id) {\n    // If already a valid UUID, return as-is\n    if ((0,uuid__WEBPACK_IMPORTED_MODULE_1__.validate)(ride_id)) {\n        return ride_id;\n    }\n    // Handle special test UUID format (all zeros pattern)\n    if (ride_id === '00000000-0000-0000-0000-000000000300') {\n        return ride_id; // Allow the test ride ID even though it's not a valid UUID format\n    }\n    // If starts with 'test_', use a known valid ride ID for testing\n    if (ride_id.startsWith('test_')) {\n        return '10614cf7-4002-455f-af25-918c0b97641e'; // Use existing valid ride ID\n    }\n    // For other formats, try to convert to UUID or generate new one\n    return (0,uuid__WEBPACK_IMPORTED_MODULE_1__.v4)();\n}\n// Validate required parameters\nfunction validateEventParams(params) {\n    const { campaign_id, ad_id, ride_id, event_type } = params;\n    if (!ride_id) {\n        return {\n            isValid: false,\n            error: 'missing_ride_id'\n        };\n    }\n    if (!campaign_id) {\n        return {\n            isValid: false,\n            error: 'missing_campaign_id'\n        };\n    }\n    if (!ad_id) {\n        return {\n            isValid: false,\n            error: 'missing_ad_id'\n        };\n    }\n    if (!event_type || ![\n        'impression',\n        'click',\n        'conversion',\n        'test_sync'\n    ].includes(event_type)) {\n        return {\n            isValid: false,\n            error: 'invalid_event_type'\n        };\n    }\n    return {\n        isValid: true\n    };\n}\nasync function handler(req, res) {\n    try {\n        if (req.method === \"GET\") {\n            // AD REQUEST - Serve ad with frequency cap check\n            return await serveAd(req, res);\n        } else if (req.method === \"POST\") {\n            // EVENT TRACKING - Record impression/click\n            return await recordEvent(req, res);\n        } else {\n            return res.status(405).json({\n                error: \"method_not_allowed\"\n            });\n        }\n    } catch (e) {\n        console.error('SDK API Error:', e);\n        res.status(500).json({\n            error: e.message\n        });\n    }\n}\nasync function serveAd(req, res) {\n    const { ride_id, device_id, zone = \"post-ride\" } = req.query;\n    if (!ride_id) {\n        return res.status(400).json({\n            error: \"missing_ride_id\"\n        });\n    }\n    // Normalize ride_id to ensure compatibility\n    const normalizedRideId = normalizeRideId(ride_id);\n    try {\n        // Check frequency cap - only 1 ad per ride_id\n        const { data: existingAds, error: checkError } = await supabase.from('analytics_events').select('id').eq('ride_id', normalizedRideId).limit(1);\n        if (checkError) throw checkError;\n        if (existingAds && existingAds.length > 0) {\n            return res.status(200).json({\n                ad: null,\n                message: \"frequency_cap_reached\",\n                ride_id: normalizedRideId\n            });\n        }\n        // Get active campaign with available budget\n        const { data: campaigns, error: campaignError } = await supabase.from('campaigns').select('id, name, budget_cents, status').eq('status', 'active').gt('budget_cents', 0).limit(1);\n        if (campaignError) throw campaignError;\n        if (!campaigns || campaigns.length === 0) {\n            return res.status(200).json({\n                ad: null,\n                message: \"no_available_campaigns\"\n            });\n        }\n        const campaign = campaigns[0];\n        // Get active ads for this campaign\n        const { data: ads, error: adsError } = await supabase.from('ads').select('id, title, media_url, status').eq('campaign_id', campaign.id).eq('status', 'active');\n        if (adsError) throw adsError;\n        if (!ads || ads.length === 0) {\n            return res.status(200).json({\n                ad: null,\n                message: \"no_active_ads\"\n            });\n        }\n        // Select random ad\n        const selectedAd = ads[Math.floor(Math.random() * ads.length)];\n        // Return ad with tracking info\n        return res.status(200).json({\n            ad: {\n                id: selectedAd.id,\n                campaign_id: campaign.id,\n                title: selectedAd.title,\n                media_url: selectedAd.media_url,\n                tracking_pixel: `/api/sdk/events?event_type=impression&campaign_id=${campaign.id}&ad_id=${selectedAd.id}&ride_id=${normalizedRideId}`,\n                click_url: `/api/sdk/events?event_type=click&campaign_id=${campaign.id}&ad_id=${selectedAd.id}&ride_id=${normalizedRideId}`\n            },\n            ride_id: normalizedRideId,\n            zone\n        });\n    } catch (error) {\n        console.error('Serve ad error:', error);\n        return res.status(500).json({\n            error: 'Failed to serve ad'\n        });\n    }\n}\nasync function recordEvent(req, res) {\n    const { campaign_id, ad_id, ride_id, device_id = null, zone = \"post-ride\", event_type, meta = {} } = req.body || {};\n    // Validate all required parameters\n    const validation = validateEventParams({\n        campaign_id,\n        ad_id,\n        ride_id,\n        event_type\n    });\n    if (!validation.isValid) {\n        return res.status(400).json({\n            error: validation.error\n        });\n    }\n    // Normalize ride_id to ensure compatibility\n    const normalizedRideId = normalizeRideId(ride_id);\n    try {\n        // Record event\n        const { data: eventData, error: eventError } = await supabase.from('analytics_events').insert({\n            campaign_id,\n            ad_id,\n            event_type,\n            device_id,\n            region: zone,\n            ride_id: normalizedRideId,\n            meta\n        }).select().single();\n        if (eventError) throw eventError;\n        // If it's a click, trigger driver payout\n        if (event_type === 'click') {\n            await triggerDriverPayout(normalizedRideId, campaign_id, ad_id);\n        }\n        res.status(200).json({\n            success: true,\n            event_id: eventData.id,\n            ride_id: normalizedRideId,\n            event_type\n        });\n    } catch (error) {\n        console.error('Record event error:', error);\n        return res.status(500).json({\n            error: 'Failed to record event'\n        });\n    }\n}\nasync function triggerDriverPayout(ride_id, campaign_id, ad_id) {\n    try {\n        // Simple payout logic - 0.10 KES per click\n        const payoutAmount = 10; // 10 cents = 0.10 KES\n        // Find driver wallet (simplified - in production would link via ride data)\n        const { data: driverWallet, error: walletError } = await supabase.from('wallets').select('id, balance_cents').not('driver_id', 'is', null).limit(1).single();\n        if (walletError || !driverWallet) {\n            console.log('No driver wallet found for payout');\n            return;\n        }\n        // Credit driver wallet\n        const { error: txError } = await supabase.from('transactions').insert({\n            wallet_id: driverWallet.id,\n            type: 'credit',\n            amount_cents: payoutAmount,\n            ref: `click_payout_${ride_id}`,\n            memo: `Click payout for ride ${ride_id}`\n        });\n        if (txError) throw txError;\n        // Update wallet balance\n        const { error: updateError } = await supabase.from('wallets').update({\n            balance_cents: driverWallet.balance_cents + payoutAmount\n        }).eq('id', driverWallet.id);\n        if (updateError) throw updateError;\n        console.log(`💰 Driver payout: ${payoutAmount} cents for ride ${ride_id}`);\n    } catch (error) {\n        console.error('Driver payout error:', error);\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9wYWdlcy9hcGkvc2RrL2V2ZW50cy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7Ozs7Ozs7Ozs7Ozs7O0NBY0MsR0FHb0Q7QUFDRztBQUV4RCxNQUFNSyxXQUFXTCxtRUFBWUEsQ0FBQ00sMENBQW9DLEVBQUdBLFFBQVFDLEdBQUcsQ0FBQ0UseUJBQXlCO0FBRTFHLDJEQUEyRDtBQUMzRCxTQUFTQyxnQkFBZ0JDLE9BQWU7SUFDdEMsd0NBQXdDO0lBQ3hDLElBQUlQLDhDQUFNQSxDQUFDTyxVQUFVO1FBQ25CLE9BQU9BO0lBQ1Q7SUFFQSxzREFBc0Q7SUFDdEQsSUFBSUEsWUFBWSx3Q0FBd0M7UUFDdEQsT0FBT0EsU0FBUyxrRUFBa0U7SUFDcEY7SUFFQSxnRUFBZ0U7SUFDaEUsSUFBSUEsUUFBUUMsVUFBVSxDQUFDLFVBQVU7UUFDL0IsT0FBTyx3Q0FBd0MsNkJBQTZCO0lBQzlFO0lBRUEsZ0VBQWdFO0lBQ2hFLE9BQU9WLHdDQUFNQTtBQUNmO0FBRUEsK0JBQStCO0FBQy9CLFNBQVNXLG9CQUFvQkMsTUFBVztJQUN0QyxNQUFNLEVBQUVDLFdBQVcsRUFBRUMsS0FBSyxFQUFFTCxPQUFPLEVBQUVNLFVBQVUsRUFBRSxHQUFHSDtJQUVwRCxJQUFJLENBQUNILFNBQVM7UUFDWixPQUFPO1lBQUVPLFNBQVM7WUFBT0MsT0FBTztRQUFrQjtJQUNwRDtJQUVBLElBQUksQ0FBQ0osYUFBYTtRQUNoQixPQUFPO1lBQUVHLFNBQVM7WUFBT0MsT0FBTztRQUFzQjtJQUN4RDtJQUVBLElBQUksQ0FBQ0gsT0FBTztRQUNWLE9BQU87WUFBRUUsU0FBUztZQUFPQyxPQUFPO1FBQWdCO0lBQ2xEO0lBRUEsSUFBSSxDQUFDRixjQUFjLENBQUM7UUFBQztRQUFjO1FBQVM7UUFBYztLQUFZLENBQUNHLFFBQVEsQ0FBQ0gsYUFBYTtRQUMzRixPQUFPO1lBQUVDLFNBQVM7WUFBT0MsT0FBTztRQUFxQjtJQUN2RDtJQUVBLE9BQU87UUFBRUQsU0FB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LENBQUMsZ0JBQ0wwQixNQUFNLENBQUM7WUFDTlksV0FBV0wsYUFBYXJCLEVBQUU7WUFDMUIyQixNQUFNO1lBQ05DLGNBQWNSO1lBQ2RTLEtBQUssQ0FBQyxhQUFhLEVBQUVyRSxTQUFTO1lBQzlCc0UsTUFBTSxDQUFDLHNCQUFzQixFQUFFdEUsU0FBUztRQUMxQztRQUVGLElBQUlpRSxTQUFTLE1BQU1BO1FBRW5CLHdCQUF3QjtRQUN4QixNQUFNLEVBQUV6RCxPQUFPK0QsV0FBVyxFQUFFLEdBQUcsTUFBTTdFLFNBQ2xDa0MsSUFBSSxDQUFDLFdBQ0w0QyxNQUFNLENBQUM7WUFDTkMsZUFBZVosYUFBYVksYUFBYSxHQUFHYjtRQUM5QyxHQUNDOUIsRUFBRSxDQUFDLE1BQU0rQixhQUFhckIsRUFBRTtRQUUzQixJQUFJK0IsYUFBYSxNQUFNQTtRQUV2QnBELFFBQVE2QyxHQUFHLENBQUMsQ0FBQyxrQkFBa0IsRUFBRUosYUFBYSxnQkFBZ0IsRUFBRTVELFNBQVM7SUFFM0UsRUFBRSxPQUFPUSxPQUFPO1FBQ2RXLFFBQVFYLEtBQUssQ0FBQyx3QkFBd0JBO0lBQ3hDO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9naW8vRG9jdW1lbnRzL2FkZ28vc3JjL3BhZ2VzL2FwaS9zZGsvZXZlbnRzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQWRHbyBQbGF0Zm9ybSAtIEFkdmFuY2VkIEFkdmVydGlzaW5nIFRlY2hub2xvZ3kgU3VpdGVcbiAqIFxuICogQ29weXJpZ2h0IChjKSAyMDI1IEFkR28gU29sdXRpb25zIExpbWl0ZWQuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIHByb3ByaWV0YXJ5IGFuZCBjb25maWRlbnRpYWwuXG4gKiBVbmF1dGhvcml6ZWQgY29weWluZywgbW9kaWZpY2F0aW9uLCBkaXN0cmlidXRpb24sIG9yIHVzZSBvZiB0aGlzIGZpbGUsXG4gKiB2aWEgYW55IG1lZGl1bSwgaXMgc3RyaWN0bHkgcHJvaGliaXRlZCB3aXRob3V0IGV4cGxpY2l0IHdyaXR0ZW4gY29uc2VudC5cbiAqIFxuICogRm9yIGxpY2Vuc2luZyBpbmZvcm1hdGlvbiwgcGxlYXNlIGNvbnRhY3Q6IGxlZ2FsQGFkZ29zb2x1dGlvbnMuY29tXG4gKiBcbiAqIEJ1aWxkOiAyMDI1MTAxNV8wNzM4MzBcbiAqIEdlbmVyYXRlZDogMjAyNS0xMC0xNSAwNDozODozNiBVVENcbiAqL1xuXG5pbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tIFwibmV4dFwiO1xuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSBcIkBzdXBhYmFzZS9zdXBhYmFzZS1qc1wiO1xuaW1wb3J0IHsgdjQgYXMgdXVpZHY0LCB2YWxpZGF0ZSBhcyBpc1VVSUQgfSBmcm9tICd1dWlkJztcblxuY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQocHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMISwgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSEpO1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gdmFsaWRhdGUgYW5kIG5vcm1hbGl6ZSByaWRlX2lkIGZvcm1hdFxuZnVuY3Rpb24gbm9ybWFsaXplUmlkZUlkKHJpZGVfaWQ6IHN0cmluZyk6IHN0cmluZyB7XG4gIC8vIElmIGFscmVhZHkgYSB2YWxpZCBVVUlELCByZXR1cm4gYXMtaXNcbiAgaWYgKGlzVVVJRChyaWRlX2lkKSkge1xuICAgIHJldHVybiByaWRlX2lkO1xuICB9XG4gIFxuICAvLyBIYW5kbGUgc3BlY2lhbCB0ZXN0IFVVSUQgZm9ybWF0IChhbGwgemVyb3MgcGF0dGVybilcbiAgaWYgKHJpZGVfaWQgPT09ICcwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAzMDAnKSB7XG4gICAgcmV0dXJuIHJpZGVfaWQ7IC8vIEFsbG93IHRoZSB0ZXN0IHJpZGUgSUQgZXZlbiB0aG91Z2ggaXQncyBub3QgYSB2YWxpZCBVVUlEIGZvcm1hdFxuICB9XG4gIFxuICAvLyBJZiBzdGFydHMgd2l0aCAndGVzdF8nLCB1c2UgYSBrbm93biB2YWxpZCByaWRlIElEIGZvciB0ZXN0aW5nXG4gIGlmIChyaWRlX2lkLnN0YXJ0c1dpdGgoJ3Rlc3RfJykpIHtcbiAgICByZXR1cm4gJzEwNjE0Y2Y3LTQwMDItNDU1Zi1hZjI1LTkxOGMwYjk3NjQxZSc7IC8vIFVzZSBleGlzdGluZyB2YWxpZCByaWRlIElEXG4gIH1cbiAgXG4gIC8vIEZvciBvdGhlciBmb3JtYXRzLCB0cnkgdG8gY29udmVydCB0byBVVUlEIG9yIGdlbmVyYXRlIG5ldyBvbmVcbiAgcmV0dXJuIHV1aWR2NCgpO1xufVxuXG4vLyBWYWxpZGF0ZSByZXF1aXJlZCBwYXJhbWV0ZXJzXG5mdW5jdGlvbiB2YWxpZGF0ZUV2ZW50UGFyYW1zKHBhcmFtczogYW55KTogeyBpc1ZhbGlkOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9IHtcbiAgY29uc3QgeyBjYW1wYWlnbl9pZCwgYWRfaWQsIHJpZGVfaWQsIGV2ZW50X3R5cGUgfSA9IHBhcmFtcztcbiAgXG4gIGlmICghcmlkZV9pZCkge1xuICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcjogJ21pc3NpbmdfcmlkZV9pZCcgfTtcbiAgfVxuICBcbiAgaWYgKCFjYW1wYWlnbl9pZCkge1xuICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcjogJ21pc3NpbmdfY2FtcGFpZ25faWQnIH07XG4gIH1cbiAgXG4gIGlmICghYWRfaWQpIHtcbiAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgZXJyb3I6ICdtaXNzaW5nX2FkX2lkJyB9O1xuICB9XG4gIFxuICBpZiAoIWV2ZW50X3R5cGUgfHwgIVsnaW1wcmVzc2lvbicsICdjbGljaycsICdjb252ZXJzaW9uJywgJ3Rlc3Rfc3luYyddLmluY2x1ZGVzKGV2ZW50X3R5cGUpKSB7XG4gICAgcmV0dXJuIHsgaXNWYWxpZDogZmFsc2UsIGVycm9yOiAnaW52YWxpZF9ldmVudF90eXBlJyB9O1xuICB9XG4gIFxuICByZXR1cm4geyBpc1ZhbGlkOiB0cnVlIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcbiAgdHJ5IHtcbiAgICBpZiAocmVxLm1ldGhvZCA9PT0gXCJHRVRcIikge1xuICAgICAgLy8gQUQgUkVRVUVTVCAtIFNlcnZlIGFkIHdpdGggZnJlcXVlbmN5IGNhcCBjaGVja1xuICAgICAgcmV0dXJuIGF3YWl0IHNlcnZlQWQocmVxLCByZXMpO1xuICAgIH0gZWxzZSBpZiAocmVxLm1ldGhvZCA9PT0gXCJQT1NUXCIpIHtcbiAgICAgIC8vIEVWRU5UIFRSQUNLSU5HIC0gUmVjb3JkIGltcHJlc3Npb24vY2xpY2tcbiAgICAgIHJldHVybiBhd2FpdCByZWNvcmRFdmVudChyZXEsIHJlcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiBcIm1ldGhvZF9ub3RfYWxsb3dlZFwiIH0pO1xuICAgIH1cbiAgfSBjYXRjaCAoZTogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcignU0RLIEFQSSBFcnJvcjonLCBlKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBlLm1lc3NhZ2UgfSk7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gc2VydmVBZChyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICBjb25zdCB7IHJpZGVfaWQsIGRldmljZV9pZCwgem9uZSA9IFwicG9zdC1yaWRlXCIgfSA9IHJlcS5xdWVyeTtcbiAgXG4gIGlmICghcmlkZV9pZCkge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiBcIm1pc3NpbmdfcmlkZV9pZFwiIH0pO1xuICB9XG4gIFxuICAvLyBOb3JtYWxpemUgcmlkZV9pZCB0byBlbnN1cmUgY29tcGF0aWJpbGl0eVxuICBjb25zdCBub3JtYWxpemVkUmlkZUlkID0gbm9ybWFsaXplUmlkZUlkKHJpZGVfaWQgYXMgc3RyaW5nKTtcbiAgXG4gIHRyeSB7XG4gICAgLy8gQ2hlY2sgZnJlcXVlbmN5IGNhcCAtIG9ubHkgMSBhZCBwZXIgcmlkZV9pZFxuICAgIGNvbnN0IHsgZGF0YTogZXhpc3RpbmdBZHMsIGVycm9yOiBjaGVja0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2FuYWx5dGljc19ldmVudHMnKVxuICAgICAgLnNlbGVjdCgnaWQnKVxuICAgICAgLmVxKCdyaWRlX2lkJywgbm9ybWFsaXplZFJpZGVJZClcbiAgICAgIC5saW1pdCgxKTtcbiAgICBcbiAgICBpZiAoY2hlY2tFcnJvcikgdGhyb3cgY2hlY2tFcnJvcjtcbiAgICBcbiAgICBpZiAoZXhpc3RpbmdBZHMgJiYgZXhpc3RpbmdBZHMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgXG4gICAgICAgIGFkOiBudWxsLCBcbiAgICAgICAgbWVzc2FnZTogXCJmcmVxdWVuY3lfY2FwX3JlYWNoZWRcIixcbiAgICAgICAgcmlkZV9pZDogbm9ybWFsaXplZFJpZGVJZCBcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBHZXQgYWN0aXZlIGNhbXBhaWduIHdpdGggYXZhaWxhYmxlIGJ1ZGdldFxuICAgIGNvbnN0IHsgZGF0YTogY2FtcGFpZ25zLCBlcnJvcjogY2FtcGFpZ25FcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdjYW1wYWlnbnMnKVxuICAgICAgLnNlbGVjdCgnaWQsIG5hbWUsIGJ1ZGdldF9jZW50cywgc3RhdHVzJylcbiAgICAgIC5lcSgnc3RhdHVzJywgJ2FjdGl2ZScpXG4gICAgICAuZ3QoJ2J1ZGdldF9jZW50cycsIDApXG4gICAgICAubGltaXQoMSk7XG4gICAgXG4gICAgaWYgKGNhbXBhaWduRXJyb3IpIHRocm93IGNhbXBhaWduRXJyb3I7XG4gICAgXG4gICAgaWYgKCFjYW1wYWlnbnMgfHwgY2FtcGFpZ25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgXG4gICAgICAgIGFkOiBudWxsLCBcbiAgICAgICAgbWVzc2FnZTogXCJub19hdmFpbGFibGVfY2FtcGFpZ25zXCIgXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgY2FtcGFpZ24gPSBjYW1wYWlnbnNbMF07XG4gICAgXG4gICAgLy8gR2V0IGFjdGl2ZSBhZHMgZm9yIHRoaXMgY2FtcGFpZ25cbiAgICBjb25zdCB7IGRhdGE6IGFkcywgZXJyb3I6IGFkc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2FkcycpXG4gICAgICAuc2VsZWN0KCdpZCwgdGl0bGUsIG1lZGlhX3VybCwgc3RhdHVzJylcbiAgICAgIC5lcSgnY2FtcGFpZ25faWQnLCBjYW1wYWlnbi5pZClcbiAgICAgIC5lcSgnc3RhdHVzJywgJ2FjdGl2ZScpO1xuICAgIFxuICAgIGlmIChhZHNFcnJvcikgdGhyb3cgYWRzRXJyb3I7XG4gICAgXG4gICAgaWYgKCFhZHMgfHwgYWRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgXG4gICAgICAgIGFkOiBudWxsLCBcbiAgICAgICAgbWVzc2FnZTogXCJub19hY3RpdmVfYWRzXCIgXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLy8gU2VsZWN0IHJhbmRvbSBhZFxuICAgIGNvbnN0IHNlbGVjdGVkQWQgPSBhZHNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogYWRzLmxlbmd0aCldO1xuICAgIFxuICAgIC8vIFJldHVybiBhZCB3aXRoIHRyYWNraW5nIGluZm9cbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgYWQ6IHtcbiAgICAgICAgaWQ6IHNlbGVjdGVkQWQuaWQsXG4gICAgICAgIGNhbXBhaWduX2lkOiBjYW1wYWlnbi5pZCxcbiAgICAgICAgdGl0bGU6IHNlbGVjdGVkQWQudGl0bGUsXG4gICAgICAgIG1lZGlhX3VybDogc2VsZWN0ZWRBZC5tZWRpYV91cmwsXG4gICAgICAgIHRyYWNraW5nX3BpeGVsOiBgL2FwaS9zZGsvZXZlbnRzP2V2ZW50X3R5cGU9aW1wcmVzc2lvbiZjYW1wYWlnbl9pZD0ke2NhbXBhaWduLmlkfSZhZF9pZD0ke3NlbGVjdGVkQWQuaWR9JnJpZGVfaWQ9JHtub3JtYWxpemVkUmlkZUlkfWAsXG4gICAgICAgIGNsaWNrX3VybDogYC9hcGkvc2RrL2V2ZW50cz9ldmVudF90eXBlPWNsaWNrJmNhbXBhaWduX2lkPSR7Y2FtcGFpZ24uaWR9JmFkX2lkPSR7c2VsZWN0ZWRBZC5pZH0mcmlkZV9pZD0ke25vcm1hbGl6ZWRSaWRlSWR9YFxuICAgICAgfSxcbiAgICAgIHJpZGVfaWQ6IG5vcm1hbGl6ZWRSaWRlSWQsXG4gICAgICB6b25lXG4gICAgfSk7XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignU2VydmUgYWQgZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIHNlcnZlIGFkJyB9KTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiByZWNvcmRFdmVudChyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICBjb25zdCB7IFxuICAgIGNhbXBhaWduX2lkLCBcbiAgICBhZF9pZCwgXG4gICAgcmlkZV9pZCwgXG4gICAgZGV2aWNlX2lkID0gbnVsbCwgXG4gICAgem9uZSA9IFwicG9zdC1yaWRlXCIsIFxuICAgIGV2ZW50X3R5cGUsIFxuICAgIG1ldGEgPSB7fSBcbiAgfSA9IHJlcS5ib2R5IHx8IHt9O1xuICBcbiAgLy8gVmFsaWRhdGUgYWxsIHJlcXVpcmVkIHBhcmFtZXRlcnNcbiAgY29uc3QgdmFsaWRhdGlvbiA9IHZhbGlkYXRlRXZlbnRQYXJhbXMoeyBjYW1wYWlnbl9pZCwgYWRfaWQsIHJpZGVfaWQsIGV2ZW50X3R5cGUgfSk7XG4gIGlmICghdmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IgfSk7XG4gIH1cbiAgXG4gIC8vIE5vcm1hbGl6ZSByaWRlX2lkIHRvIGVuc3VyZSBjb21wYXRpYmlsaXR5XG4gIGNvbnN0IG5vcm1hbGl6ZWRSaWRlSWQgPSBub3JtYWxpemVSaWRlSWQocmlkZV9pZCk7XG4gIFxuICB0cnkge1xuICAgIC8vIFJlY29yZCBldmVudFxuICAgIGNvbnN0IHsgZGF0YTogZXZlbnREYXRhLCBlcnJvcjogZXZlbnRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhbmFseXRpY3NfZXZlbnRzJylcbiAgICAgIC5pbnNlcnQoe1xuICAgICAgICBjYW1wYWlnbl9pZCxcbiAgICAgICAgYWRfaWQsXG4gICAgICAgIGV2ZW50X3R5cGUsXG4gICAgICAgIGRldmljZV9pZCxcbiAgICAgICAgcmVnaW9uOiB6b25lLFxuICAgICAgICByaWRlX2lkOiBub3JtYWxpemVkUmlkZUlkLFxuICAgICAgICBtZXRhXG4gICAgICB9KVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKCk7XG4gICAgXG4gICAgaWYgKGV2ZW50RXJyb3IpIHRocm93IGV2ZW50RXJyb3I7XG4gICAgXG4gICAgLy8gSWYgaXQncyBhIGNsaWNrLCB0cmlnZ2VyIGRyaXZlciBwYXlvdXRcbiAgICBpZiAoZXZlbnRfdHlwZSA9PT0gJ2NsaWNrJykge1xuICAgICAgYXdhaXQgdHJpZ2dlckRyaXZlclBheW91dChub3JtYWxpemVkUmlkZUlkLCBjYW1wYWlnbl9pZCwgYWRfaWQpO1xuICAgIH1cbiAgICBcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IFxuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGV2ZW50X2lkOiBldmVudERhdGEuaWQsXG4gICAgICByaWRlX2lkOiBub3JtYWxpemVkUmlkZUlkLFxuICAgICAgZXZlbnRfdHlwZSBcbiAgICB9KTtcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdSZWNvcmQgZXZlbnQgZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIHJlY29yZCBldmVudCcgfSk7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gdHJpZ2dlckRyaXZlclBheW91dChyaWRlX2lkOiBzdHJpbmcsIGNhbXBhaWduX2lkOiBzdHJpbmcsIGFkX2lkOiBzdHJpbmcpIHtcbiAgdHJ5IHtcbiAgICAvLyBTaW1wbGUgcGF5b3V0IGxvZ2ljIC0gMC4xMCBLRVMgcGVyIGNsaWNrXG4gICAgY29uc3QgcGF5b3V0QW1vdW50ID0gMTA7IC8vIDEwIGNlbnRzID0gMC4xMCBLRVNcbiAgICBcbiAgICAvLyBGaW5kIGRyaXZlciB3YWxsZXQgKHNpbXBsaWZpZWQgLSBpbiBwcm9kdWN0aW9uIHdvdWxkIGxpbmsgdmlhIHJpZGUgZGF0YSlcbiAgICBjb25zdCB7IGRhdGE6IGRyaXZlcldhbGxldCwgZXJyb3I6IHdhbGxldEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3dhbGxldHMnKVxuICAgICAgLnNlbGVjdCgnaWQsIGJhbGFuY2VfY2VudHMnKVxuICAgICAgLm5vdCgnZHJpdmVyX2lkJywgJ2lzJywgbnVsbClcbiAgICAgIC5saW1pdCgxKVxuICAgICAgLnNpbmdsZSgpO1xuICAgIFxuICAgIGlmICh3YWxsZXRFcnJvciB8fCAhZHJpdmVyV2FsbGV0KSB7XG4gICAgICBjb25zb2xlLmxvZygnTm8gZHJpdmVyIHdhbGxldCBmb3VuZCBmb3IgcGF5b3V0Jyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIC8vIENyZWRpdCBkcml2ZXIgd2FsbGV0XG4gICAgY29uc3QgeyBlcnJvcjogdHhFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd0cmFuc2FjdGlvbnMnKVxuICAgICAgLmluc2VydCh7XG4gICAgICAgIHdhbGxldF9pZDogZHJpdmVyV2FsbGV0LmlkLFxuICAgICAgICB0eXBlOiAnY3JlZGl0JyxcbiAgICAgICAgYW1vdW50X2NlbnRzOiBwYXlvdXRBbW91bnQsXG4gICAgICAgIHJlZjogYGNsaWNrX3BheW91dF8ke3JpZGVfaWR9YCxcbiAgICAgICAgbWVtbzogYENsaWNrIHBheW91dCBmb3IgcmlkZSAke3JpZGVfaWR9YFxuICAgICAgfSk7XG4gICAgXG4gICAgaWYgKHR4RXJyb3IpIHRocm93IHR4RXJyb3I7XG4gICAgXG4gICAgLy8gVXBkYXRlIHdhbGxldCBiYWxhbmNlXG4gICAgY29uc3QgeyBlcnJvcjogdXBkYXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnd2FsbGV0cycpXG4gICAgICAudXBkYXRlKHsgXG4gICAgICAgIGJhbGFuY2VfY2VudHM6IGRyaXZlcldhbGxldC5iYWxhbmNlX2NlbnRzICsgcGF5b3V0QW1vdW50IFxuICAgICAgfSlcbiAgICAgIC5lcSgnaWQnLCBkcml2ZXJXYWxsZXQuaWQpO1xuICAgIFxuICAgIGlmICh1cGRhdGVFcnJvcikgdGhyb3cgdXBkYXRlRXJyb3I7XG4gICAgXG4gICAgY29uc29sZS5sb2coYPCfkrAgRHJpdmVyIHBheW91dDogJHtwYXlvdXRBbW91bnR9IGNlbnRzIGZvciByaWRlICR7cmlkZV9pZH1gKTtcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdEcml2ZXIgcGF5b3V0IGVycm9yOicsIGVycm9yKTtcbiAgfVxufSJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJ2NCIsInV1aWR2NCIsInZhbGlkYXRlIiwiaXNVVUlEIiwic3VwYWJhc2UiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsIm5vcm1hbGl6ZVJpZGVJZCIsInJpZGVfaWQiLCJzdGFydHNXaXRoIiwidmFsaWRhdGVFdmVudFBhcmFtcyIsInBhcmFtcyIsImNhbXBhaWduX2lkIiwiYWRfaWQiLCJldmVudF90eXBlIiwiaXNWYWxpZCIsImVycm9yIiwiaW5jbHVkZXMiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwic2VydmVBZCIsInJlY29yZEV2ZW50Iiwic3RhdHVzIiwianNvbiIsImUiLCJjb25zb2xlIiwibWVzc2FnZSIsImRldmljZV9pZCIsInpvbmUiLCJxdWVyeSIsIm5vcm1hbGl6ZWRSaWRlSWQiLCJkYXRhIiwiZXhpc3RpbmdBZHMiLCJjaGVja0Vycm9yIiwiZnJvbSIsInNlbGVjdCIsImVxIiwibGltaXQiLCJsZW5ndGgiLCJhZCIsImNhbXBhaWducyIsImNhbXBhaWduRXJyb3IiLCJndCIsImNhbXBhaWduIiwiYWRzIiwiYWRzRXJyb3IiLCJpZCIsInNlbGVjdGVkQWQiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0aXRsZSIsIm1lZGlhX3VybCIsInRyYWNraW5nX3BpeGVsIiwiY2xpY2tfdXJsIiwibWV0YSIsImJvZHkiLCJ2YWxpZGF0aW9uIiwiZXZlbnREYXRhIiwiZXZlbnRFcnJvciIsImluc2VydCIsInJlZ2lvbiIsInNpbmdsZSIsInRyaWdnZXJEcml2ZXJQYXlvdXQiLCJzdWNjZXNzIiwiZXZlbnRfaWQiLCJwYXlvdXRBbW91bnQiLCJkcml2ZXJXYWxsZXQiLCJ3YWxsZXRFcnJvciIsIm5vdCIsImxvZyIsInR4RXJyb3IiLCJ3YWxsZXRfaWQiLCJ0eXBlIiwiYW1vdW50X2NlbnRzIiwicmVmIiwibWVtbyIsInVwZGF0ZUVycm9yIiwidXBkYXRlIiwiYmFsYW5jZV9jZW50cyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./src/pages/api/sdk/events.ts\n");

/***/ }),

/***/ "@opentelemetry/api":
/*!*************************************!*\
  !*** external "@opentelemetry/api" ***!
  \*************************************/
/***/ ((module) => {

module.exports = require("@opentelemetry/api");

/***/ }),

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "uuid":
/*!***********************!*\
  !*** external "uuid" ***!
  \***********************/
/***/ ((module) => {

module.exports = import("uuid");;

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsdk%2Fevents&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fsdk%2Fevents.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();
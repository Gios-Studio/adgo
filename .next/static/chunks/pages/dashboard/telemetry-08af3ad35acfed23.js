(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[428],{1188:(e,s,t)=>{"use strict";t.d(s,{BT:()=>c,Wu:()=>o,ZB:()=>d,Zp:()=>n,aR:()=>i});var r=t(7876),a=t(4232),l=t(7025);let n=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});n.displayName="Card";let i=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",t),...a})});i.displayName="CardHeader";let d=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("h3",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});d.displayName="CardTitle";let c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("p",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",t),...a})});c.displayName="CardDescription";let o=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",t),...a})});o.displayName="CardContent",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",t),...a})}).displayName="CardFooter"},4164:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>O});var r=t(7876),a=t(4232),l=t(6958),n=t(1188),i=t(6423),d=t(9917),c=t(9432),o=t(8725),x=t(6076),u=t(2257),m=t(7025);let h=c.bL;c.YJ;let f=c.WT,p=a.forwardRef((e,s)=>{let{className:t,children:a,...l}=e;return(0,r.jsxs)(c.l9,{ref:s,className:(0,m.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...l,children:[a,(0,r.jsx)(c.In,{asChild:!0,children:(0,r.jsx)(o.A,{className:"h-4 w-4 opacity-50"})})]})});p.displayName=c.l9.displayName;let g=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(c.PP,{ref:s,className:(0,m.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,r.jsx)(x.A,{className:"h-4 w-4"})})});g.displayName=c.PP.displayName;let j=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(c.wn,{ref:s,className:(0,m.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,r.jsx)(o.A,{className:"h-4 w-4"})})});j.displayName=c.wn.displayName;let y=a.forwardRef((e,s)=>{let{className:t,children:a,position:l="popper",...n}=e;return(0,r.jsx)(c.ZL,{children:(0,r.jsxs)(c.UC,{ref:s,className:(0,m.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:l,...n,children:[(0,r.jsx)(g,{}),(0,r.jsx)(c.LM,{className:(0,m.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,r.jsx)(j,{})]})})});y.displayName=c.UC.displayName,a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(c.JU,{ref:s,className:(0,m.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...a})}).displayName=c.JU.displayName;let v=a.forwardRef((e,s)=>{let{className:t,children:a,...l}=e;return(0,r.jsxs)(c.q7,{ref:s,className:(0,m.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(c.VF,{children:(0,r.jsx)(u.A,{className:"h-4 w-4"})})}),(0,r.jsx)(c.p4,{children:a})]})});v.displayName=c.q7.displayName,a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(c.wv,{ref:s,className:(0,m.cn)("-mx-1 my-1 h-px bg-muted",t),...a})}).displayName=c.wv.displayName;var b=t(4007),N=t(5907),w=t(4069),_=t(570),R=t(7874),k=t(7362),Z=t(4955),A=t(9306),L=t(3947),I=t(8246),B=t(2320),C=t(6400),D=t(1174),S=t(6293),T=t(1180),E=t(3784),W=t(276),z=t(9247),F=t(4410),J=t(9282);function O(){var e,s,t,c,o,x,u,m,g,j,O,U;let[K,P]=(0,a.useState)(null),[V,X]=(0,a.useState)(!0),[G,M]=(0,a.useState)("7"),[q,H]=(0,a.useState)("all"),Q=(0,l.UU)("https://rkonwkggxaohpmxmzmfn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJrb253a2dneGFvaHBteG16bWZuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0OTk0MDQsImV4cCI6MjA3MzA3NTQwNH0.F8dsonOXlKqViCP-Jz5CpxS4ObXIbWoTHGLB3udjRqo");(0,a.useEffect)(()=>{Y();let e=setInterval(Y,3e4);return()=>clearInterval(e)},[G,q]);let Y=async()=>{try{X(!0);let{data:e,error:s}=await Q.from("license_usage_summary").select("*").order("usage_percentage",{ascending:!1});if(s)throw s;let{data:t,error:r}=await Q.rpc("get_license_analytics",{days_back:parseInt(G)});if(r)throw r;let a=Q.from("telemetry_events").select("\n          *,\n          licenses(license_key, plan, region)\n        ").order("timestamp",{ascending:!1}).limit(100);"all"!==q&&(a=a.eq("region",q));let{data:l,error:n}=await a;if(n)throw n;let{data:i}=await Q.from("telemetry_events").select("event_type, timestamp").gte("timestamp",new Date(Date.now()-864e5).toISOString());P({license_usage_summary:e||[],analytics:(null==t?void 0:t[0])||{},recent_events:l||[],system_health:i||[]})}catch(e){console.error("Error fetching telemetry data:",e)}finally{X(!1)}},$=()=>{if(!K)return[];let e={};K.recent_events.forEach(s=>{e[s.event_type]=(e[s.event_type]||0)+1});let s=["#8884d8","#82ca9d","#ffc658","#ff7c7c","#8dd1e1"];return Object.entries(e).map((e,t)=>{let[r,a]=e;return{name:r,value:a,color:s[t%s.length]}})};return V?(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"SDK Telemetry Dashboard"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Real-time monitoring of AdGo SDK usage, performance, and health metrics"})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)(h,{value:q,onValueChange:H,children:[(0,r.jsx)(p,{className:"w-32",children:(0,r.jsx)(f,{})}),(0,r.jsxs)(y,{children:[(0,r.jsx)(v,{value:"all",children:"All Regions"}),(0,r.jsx)(v,{value:"global",children:"Global"}),(0,r.jsx)(v,{value:"eu",children:"Europe"}),(0,r.jsx)(v,{value:"africa",children:"Africa"}),(0,r.jsx)(v,{value:"asia",children:"Asia"}),(0,r.jsx)(v,{value:"americas",children:"Americas"})]})]}),(0,r.jsxs)(h,{value:G,onValueChange:M,children:[(0,r.jsx)(p,{className:"w-32",children:(0,r.jsx)(f,{})}),(0,r.jsxs)(y,{children:[(0,r.jsx)(v,{value:"1",children:"Last 24h"}),(0,r.jsx)(v,{value:"7",children:"Last 7 days"}),(0,r.jsx)(v,{value:"30",children:"Last 30 days"})]})]}),(0,r.jsxs)(d.$,{onClick:Y,variant:"outline",children:[(0,r.jsx)(D.A,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(n.ZB,{className:"text-sm font-medium",children:"Active Licenses"}),(0,r.jsx)(S.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(n.Wu,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:(null==K||null==(e=K.analytics)?void 0:e.active_licenses)||0}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["+",(((null==K||null==(s=K.analytics)?void 0:s.active_licenses)||0)/Math.max((null==K||null==(t=K.analytics)?void 0:t.total_licenses)||1,1)*100).toFixed(1),"% active"]})]})]}),(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(n.ZB,{className:"text-sm font-medium",children:"Total API Usage"}),(0,r.jsx)(T.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(n.Wu,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:(null==K||null==(o=K.analytics)||null==(c=o.total_usage)?void 0:c.toLocaleString())||0}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Avg: ",(null==K||null==(u=K.analytics)||null==(x=u.avg_usage_per_license)?void 0:x.toFixed(1))||0," per license"]})]})]}),(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(n.ZB,{className:"text-sm font-medium",children:"Error Rate"}),(0,r.jsx)(E.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(n.Wu,{children:[(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[(null==K||null==(g=K.analytics)||null==(m=g.error_rate)?void 0:m.toFixed(2))||0,"%"]}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Last ",G," days"]})]})]}),(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(n.ZB,{className:"text-sm font-medium",children:"Top Region"}),(0,r.jsx)(W.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(n.Wu,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold capitalize",children:(null==K||null==(j=K.analytics)?void 0:j.top_region)||"Global"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Most active region"})]})]})]}),(0,r.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{children:[(0,r.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(z.A,{className:"w-5 h-5"}),"Events Timeline"]}),(0,r.jsx)(n.BT,{children:"Daily event volume over the last 7 days"})]}),(0,r.jsx)(n.Wu,{children:(0,r.jsx)(b.u,{width:"100%",height:300,children:(0,r.jsxs)(N.b,{data:(()=>{if(!K)return[];let e={};return K.recent_events.forEach(s=>{let t=new Date(s.timestamp).toLocaleDateString();e[t]=(e[t]||0)+1}),Object.entries(e).map(e=>{let[s,t]=e;return{day:s,events:t}}).slice(-7)})(),children:[(0,r.jsx)(w.d,{strokeDasharray:"3 3"}),(0,r.jsx)(_.W,{dataKey:"day"}),(0,r.jsx)(R.h,{}),(0,r.jsx)(k.m,{}),(0,r.jsx)(Z.N,{type:"monotone",dataKey:"events",stroke:"#8884d8",strokeWidth:2})]})})})]}),(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{children:[(0,r.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(D.A,{className:"w-5 h-5"}),"Event Types Distribution"]}),(0,r.jsx)(n.BT,{children:"Breakdown of event types in selected period"})]}),(0,r.jsx)(n.Wu,{children:(0,r.jsx)(b.u,{width:"100%",height:300,children:(0,r.jsxs)(A.r,{children:[(0,r.jsx)(L.F,{data:$(),cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:s,percent:t}=e;return"".concat(s," ").concat((100*t).toFixed(0),"%")},outerRadius:80,fill:"#8884d8",dataKey:"value",children:$().map((e,s)=>(0,r.jsx)(I.f,{fill:e.color},"cell-".concat(s)))}),(0,r.jsx)(k.m,{})]})})})]})]}),(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{children:[(0,r.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(F.A,{className:"w-5 h-5"}),"License Usage Overview"]}),(0,r.jsx)(n.BT,{children:"Usage statistics and health status for all active licenses"})]}),(0,r.jsx)(n.Wu,{children:(0,r.jsx)(b.u,{width:"100%",height:400,children:(0,r.jsxs)(B.E,{data:K?K.license_usage_summary.map(e=>({license_key:e.license_key.substring(0,12)+"...",usage_percentage:e.usage_percentage,plan:e.plan,region:e.region,health:e.health_status})):[],children:[(0,r.jsx)(w.d,{strokeDasharray:"3 3"}),(0,r.jsx)(_.W,{dataKey:"license_key"}),(0,r.jsx)(R.h,{}),(0,r.jsx)(k.m,{}),(0,r.jsx)(C.y,{dataKey:"usage_percentage",fill:"#8884d8"})]})})})]}),(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{children:[(0,r.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(J.A,{className:"w-5 h-5"}),"License Status Details"]}),(0,r.jsx)(n.BT,{children:"Detailed view of license usage, limits, and health status"})]}),(0,r.jsx)(n.Wu,{children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-50",children:[(0,r.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"License Key"}),(0,r.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Plan"}),(0,r.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Region"}),(0,r.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-right",children:"Usage"}),(0,r.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-right",children:"Remaining"}),(0,r.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Health"}),(0,r.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Last Used"})]})}),(0,r.jsx)("tbody",{children:null==K||null==(O=K.license_usage_summary)?void 0:O.slice(0,20).map((e,s)=>(0,r.jsxs)("tr",{className:s%2==0?"bg-white":"bg-gray-50",children:[(0,r.jsxs)("td",{className:"border border-gray-300 px-4 py-2 font-mono text-sm",children:[e.license_key.substring(0,16),"..."]}),(0,r.jsx)("td",{className:"border border-gray-300 px-4 py-2",children:(0,r.jsx)(i.E,{variant:"enterprise"===e.plan?"default":"pro"===e.plan?"secondary":"outline",children:e.plan})}),(0,r.jsx)("td",{className:"border border-gray-300 px-4 py-2 capitalize",children:e.region}),(0,r.jsxs)("td",{className:"border border-gray-300 px-4 py-2 text-right",children:[e.usage_count.toLocaleString()," / ",e.usage_limit.toLocaleString()]}),(0,r.jsx)("td",{className:"border border-gray-300 px-4 py-2 text-right",children:e.remaining_calls.toLocaleString()}),(0,r.jsx)("td",{className:"border border-gray-300 px-4 py-2 text-center",children:(0,r.jsx)("div",{className:"inline-block w-3 h-3 rounded-full ".concat((e=>{switch(e){case"healthy":return"bg-green-500";case"warning":return"bg-yellow-500";case"exceeded":return"bg-red-500";case"inactive":return"bg-gray-500";default:return"bg-blue-500"}})(e.health_status))})}),(0,r.jsx)("td",{className:"border border-gray-300 px-4 py-2 text-sm",children:e.last_used?new Date(e.last_used).toLocaleDateString():"Never"})]},e.id))})]})})})]}),(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{children:[(0,r.jsx)(n.ZB,{children:"Recent Telemetry Events"}),(0,r.jsx)(n.BT,{children:"Latest events from all SDK instances (max 50 shown)"})]}),(0,r.jsx)(n.Wu,{children:(0,r.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:null==K||null==(U=K.recent_events)?void 0:U.slice(0,50).map((e,s)=>{var t,a;return(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(i.E,{variant:"error"===e.event_type?"destructive":"outline",children:e.event_type}),(0,r.jsxs)("span",{className:"text-sm font-mono",children:[null==(a=e.licenses)||null==(t=a.license_key)?void 0:t.substring(0,12),"..."]}),(0,r.jsx)("span",{className:"text-sm text-muted-foreground capitalize",children:e.region})]}),(0,r.jsx)("div",{className:"text-xs text-muted-foreground",children:new Date(e.timestamp).toLocaleString()})]},e.id)})})})]})]})}},4540:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/telemetry",function(){return t(4164)}])},6423:(e,s,t)=>{"use strict";t.d(s,{E:()=>i});var r=t(7876);t(4232);var a=t(7137),l=t(7025);let n=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:s,variant:t,...a}=e;return(0,r.jsx)("div",{className:(0,l.cn)(n({variant:t}),s),...a})}},7025:(e,s,t)=>{"use strict";t.d(s,{cn:()=>l});var r=t(9241),a=t(9573);function l(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,a.QP)((0,r.$)(s))}},9917:(e,s,t)=>{"use strict";t.d(s,{$:()=>c});var r=t(7876),a=t(4232),l=t(2987),n=t(7137),i=t(7025);let d=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,s)=>{let{className:t,variant:a,size:n,asChild:c=!1,...o}=e,x=c?l.DX:"button";return(0,r.jsx)(x,{className:(0,i.cn)(d({variant:a,size:n,className:t})),ref:s,...o})});c.displayName="Button"}},e=>{e.O(0,[987,269,396,636,593,792],()=>e(e.s=4540)),_N_E=e.O()}]);
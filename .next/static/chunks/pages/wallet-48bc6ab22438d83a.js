(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[743],{564:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var r=a(7876),s=a(8230),l=a.n(s),n=a(9099);let i=[{href:"/dashboard",label:"Dashboard"},{href:"/adupload",label:"Ad Upload"},{href:"/analytics",label:"Analytics"},{href:"/wallet",label:"Wallet"},{href:"/settings",label:"Settings"}];function c(e){let{children:t}=e,a=(0,n.useRouter)();return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("nav",{className:"bg-white shadow-md border-b border-gray-200",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsx)("div",{className:"flex justify-between h-16",children:(0,r.jsx)("div",{className:"flex space-x-8",children:i.map(e=>{let t=a.pathname===e.href;return(0,r.jsx)(l(),{href:e.href,className:"\n                      inline-flex items-center px-1 pt-1 text-sm font-medium transition-all duration-200 ease-in-out\n                      border-b-2 hover:border-green-500 focus:outline-none focus:border-green-500\n                      ".concat(t?"border-green-600 text-green-700":"border-transparent text-gray-700 hover:text-green-600 hover:underline","\n                    "),children:e.label},e.href)})})})})}),(0,r.jsx)("main",{className:"p-8",children:t})]})}},3746:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var r=a(7876),s=a(4232),l=a(564),n=a(4613);function i(e){return new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",maximumFractionDigits:2}).format(e/100)}function c(){let[e,t]=(0,s.useState)(!0),[a,c]=(0,s.useState)(null),[d,o]=(0,s.useState)(null),[h,u]=(0,s.useState)([]);return((0,s.useEffect)(()=>{let e=!0;return(async()=>{var a,r;c(null),t(!0);try{if(!n.N)return void c("Supabase client not initialized. Check your env vars.");let{data:e,error:t}=await n.N.auth.getSession();if(t)throw t;let r=null==(a=e.session)?void 0:a.user.id;if(!r)return void c("Not signed in.");let{data:s,error:l}=await n.N.from("wallets").select("id, currency, balance_cents").eq("owner_id",r).eq("currency","KES").limit(1).maybeSingle();if(l)throw l;if(!s){o(null),u([]);return}o(s);let{data:i,error:d}=await n.N.from("transactions").select("id, type, amount_cents, ref, memo, created_at").eq("wallet_id",s.id).order("created_at",{ascending:!1}).limit(20);if(d)throw d;u(null!=i?i:[])}catch(e){console.error("Wallet fetch error →",e),c(null!=(r=e.message)?r:"Failed to load wallet.")}finally{e&&t(!1)}})(),()=>{e=!1}},[]),e)?(0,r.jsx)(l.A,{children:(0,r.jsx)("div",{children:"Loading wallet…"})}):a?(0,r.jsx)(l.A,{children:(0,r.jsxs)("div",{className:"text-red-600",children:["Error: ",a]})}):d?(0,r.jsx)(l.A,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("header",{className:"flex items-baseline justify-between",children:[(0,r.jsxs)("h1",{className:"text-2xl font-semibold",children:["Wallet (",d.currency,")"]}),(0,r.jsx)("div",{className:"text-2xl",children:i(d.balance_cents)})]}),(0,r.jsxs)("section",{children:[(0,r.jsx)("h2",{className:"text-lg font-medium mb-2",children:"Recent transactions"}),0===h.length?(0,r.jsx)("div",{className:"text-sm text-neutral-600",children:"No transactions yet."}):(0,r.jsx)("div",{className:"border rounded-lg divide-y",children:h.map(e=>{var t;return(0,r.jsxs)("div",{className:"p-3 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsxs)("div",{className:"font-medium",children:["credit"===e.type?"Credit":"Debit"," — ",null!=(t=e.ref)?t:"—"]}),(0,r.jsx)("div",{className:"text-xs text-neutral-600",children:new Date(e.created_at).toLocaleString()}),e.memo&&(0,r.jsx)("div",{className:"text-xs text-neutral-700",children:e.memo})]}),(0,r.jsxs)("div",{className:"font-semibold ".concat("credit"===e.type?"text-green-600":"text-red-600"),children:["credit"===e.type?"+":"-",i(e.amount_cents)]})]},e.id)})})]})]})}):(0,r.jsx)(l.A,{children:(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("h1",{className:"text-xl font-semibold",children:"Wallet"}),(0,r.jsx)("p",{children:"No KES wallet found yet."}),(0,r.jsx)("p",{className:"text-sm text-neutral-600",children:"Use the SQL snippet I gave you to create a wallet and a seed transaction, then refresh this page."})]})})}},7714:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/wallet",function(){return a(3746)}])}},e=>{e.O(0,[8,636,593,792],()=>e(e.s=7714)),_N_E=e.O()}]);